-- Roblox Command UI - Ultimate Edition
-- H·ªá th·ªëng l·ªánh v·ªõi nhi·ªÅu t√≠nh nƒÉng n√¢ng cao

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Bi·∫øn l∆∞u tr·∫°ng th√°i
local isNoclip = false
local isAntiAFK = false
local isInfJump = false
local isAntiKick = false
local isAutoClicker = false
local isSpin = false
local isDance = false
local isRainbow = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local isMinimized = false
local currentTheme = "dark"
local antiAFKConnection, infJumpConnection, noclipConnection, antiKickConnection, autoClickConnection, spinConnection, danceConnection, rainbowConnection

-- Themes
local themes = {
    dark = {
        main = Color3.fromRGB(25, 25, 25),
        secondary = Color3.fromRGB(40, 40, 40),
        accent = Color3.fromRGB(60, 120, 220),
        text = Color3.fromRGB(255, 255, 255),
        output = Color3.fromRGB(15, 15, 15),
        help = Color3.fromRGB(30, 30, 30)
    },
    light = {
        main = Color3.fromRGB(240, 240, 240),
        secondary = Color3.fromRGB(220, 220, 220),
        accent = Color3.fromRGB(70, 130, 250),
        text = Color3.fromRGB(0, 0, 0),
        output = Color3.fromRGB(255, 255, 255),
        help = Color3.fromRGB(230, 230, 230)
    },
    rgb = {
        main = Color3.fromRGB(50, 0, 50),
        secondary = Color3.fromRGB(80, 0, 80),
        accent = Color3.fromRGB(255, 0, 255),
        text = Color3.fromRGB(255, 255, 255),
        output = Color3.fromRGB(20, 0, 20),
        help = Color3.fromRGB(60, 0, 60)
    }
}

-- T·∫°o ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CommandUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Frame ch√≠nh
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 600, 0, 380)
mainFrame.Position = UDim2.new(0.5, -300, 0.5, -190)
mainFrame.BackgroundColor3 = themes[currentTheme].main
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Title bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 45)
titleBar.BackgroundColor3 = themes[currentTheme].secondary
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1, -140, 1, 0)
titleText.Position = UDim2.new(0, 15, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "üöÄ Ultimate Command Hub V2"
titleText.TextColor3 = themes[currentTheme].text
titleText.TextSize = 16
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Font = Enum.Font.GothamBold
titleText.Parent = titleBar

-- Theme button
local themeButton = Instance.new("TextButton")
themeButton.Size = UDim2.new(0, 35, 0, 35)
themeButton.Position = UDim2.new(1, -105, 0, 5)
themeButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
themeButton.BorderSizePixel = 0
themeButton.Text = "üé®"
themeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
themeButton.TextSize = 16
themeButton.Font = Enum.Font.GothamBold
themeButton.Parent = titleBar

local themeCorner = Instance.new("UICorner")
themeCorner.CornerRadius = UDim.new(0, 8)
themeCorner.Parent = themeButton

-- Minimize button
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -65, 0, 7)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
minimizeButton.BorderSizePixel = 0
minimizeButton.Text = "‚àí"
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.TextSize = 16
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.Parent = titleBar

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 6)
minimizeCorner.Parent = minimizeButton

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -30, 0, 7)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
closeButton.BorderSizePixel = 0
closeButton.Text = "‚úï"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 14
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeButton

-- Content frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, 0, 1, -45)
contentFrame.Position = UDim2.new(0, 0, 0, 45)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Chat output frame
local outputFrame = Instance.new("Frame")
outputFrame.Name = "OutputFrame"
outputFrame.Size = UDim2.new(0.55, -10, 1, -50)
outputFrame.Position = UDim2.new(0, 10, 0, 5)
outputFrame.BackgroundColor3 = themes[currentTheme].output
outputFrame.BorderSizePixel = 0
outputFrame.Parent = contentFrame

local outputCorner = Instance.new("UICorner")
outputCorner.CornerRadius = UDim.new(0, 8)
outputCorner.Parent = outputFrame

local outputScroll = Instance.new("ScrollingFrame")
outputScroll.Size = UDim2.new(1, -8, 1, -8)
outputScroll.Position = UDim2.new(0, 4, 0, 4)
outputScroll.BackgroundTransparency = 1
outputScroll.ScrollBarThickness = 4
outputScroll.ScrollBarImageColor3 = Color3.fromRGB(70, 70, 70)
outputScroll.Parent = outputFrame

local outputLayout = Instance.new("UIListLayout")
outputLayout.SortOrder = Enum.SortOrder.LayoutOrder
outputLayout.Padding = UDim.new(0, 2)
outputLayout.Parent = outputScroll

-- Help frame
local helpFrame = Instance.new("Frame")
helpFrame.Name = "HelpFrame"
helpFrame.Size = UDim2.new(0.45, -10, 1, -50)
helpFrame.Position = UDim2.new(0.55, 0, 0, 5)
helpFrame.BackgroundColor3 = themes[currentTheme].help
helpFrame.BorderSizePixel = 0
helpFrame.Parent = contentFrame

local helpCorner = Instance.new("UICorner")
helpCorner.CornerRadius = UDim.new(0, 8)
helpCorner.Parent = helpFrame

local helpScroll = Instance.new("ScrollingFrame")
helpScroll.Size = UDim2.new(1, -8, 1, -8)
helpScroll.Position = UDim2.new(0, 4, 0, 4)
helpScroll.BackgroundTransparency = 1
helpScroll.ScrollBarThickness = 4
helpScroll.ScrollBarImageColor3 = Color3.fromRGB(70, 70, 70)
helpScroll.Parent = helpFrame

local helpText = Instance.new("TextLabel")
helpText.Size = UDim2.new(1, -5, 0, 1500)
helpText.Position = UDim2.new(0, 2, 0, 0)
helpText.BackgroundTransparency = 1
helpText.Text = [[üöÄ L·ªÜNH C∆† B·∫¢N:
speed [s·ªë] | unspeed - T·ªëc ƒë·ªô
jump [s·ªë] | unjump - S·ª©c nh·∫£y  
fly - Vehicle Fly GUI
noclip | unnoclip - Xuy√™n t∆∞·ªùng
antiafk | unantiafk - Ch·ªëng AFK
infjump | uninfjump - Nh·∫£y v√¥ h·∫°n
reset - L√†m m·ªõi nh√¢n v·∫≠t
clear - X√≥a chat

üÜï T√çNH NƒÇNG M·ªöI:
tp [t√™n] - Teleport ƒë·∫øn ng∆∞·ªùi ch∆°i
antikick | unantikick - Ch·ªëng kick/ban
autoclick | unautoclick - Auto clicker
serverinfo - Th√¥ng tin server
rejoin - V√†o l·∫°i server
serverhop - ƒê·ªïi server
theme - ƒê·ªïi theme UI

üë• PLAYER CONTROL:
freeze [t√™n] | unfreeze [t√™n] - ƒê√≥ng bƒÉng
bring [t√™n] - K√©o ng∆∞·ªùi ch∆°i v·ªÅ
goto [t√™n] - ƒêi ƒë·∫øn ng∆∞·ªùi ch∆°i
view [t√™n] | unview - Xem camera

üéÆ CHARACTER MODS:
bighead | unbighead - ƒê·∫ßu to
smallhead | unsmallhead - ƒê·∫ßu nh·ªè
spin | unspin - Quay tr√≤n
dance | undance - Nh·∫£y m√∫a

‚ö° EXPLOITS:
walkspeed [s·ªë] - Alias t·ªëc ƒë·ªô
jumpheight [s·ªë] - Alias nh·∫£y  
gravity [s·ªë] - Thay ƒë·ªïi tr·ªçng l·ª±c
reach [s·ªë] - TƒÉng t·∫ßm v·ªõi

üîß UTILITIES:
copyid - Copy Place ID
copyjob - Copy Job ID
time - Hi·ªÉn th·ªã th·ªùi gian
ping - Hi·ªÉn th·ªã ping

üé® VISUAL EFFECTS:
rainbow | unrainbow - ƒê·ªïi m√†u rainbow
sparkles | unsparkles - L·∫•p l√°nh
fire | unfire - Hi·ªáu ·ª©ng l·ª≠a
smoke | unsmoke - Hi·ªáu ·ª©ng kh√≥i

‚ö° SCRIPT HUB:
iy - Infinite Yield
airflow - AirFlow Hub
h4x - H4X Scripts  
r15 - FE Emotes GUI
skull - Skull Hub
nameless - Nameless Admin
nathub - NatHub
arceus - Arceus X V3
shader - PShade Ultimate
native - Native Script
nolag - No Lag Hub
micup - I Wanna Run Away
speedhub - Speed Hub X
lunor - Lunor Hub
thunderz - ThunderZ

üé® THEMES: dark, light, rgb]]
helpText.TextColor3 = themes[currentTheme].text
helpText.TextSize = 9
helpText.TextXAlignment = Enum.TextXAlignment.Left
helpText.TextYAlignment = Enum.TextYAlignment.Top
helpText.Font = Enum.Font.Gotham
helpText.TextWrapped = true
helpText.Parent = helpScroll

helpScroll.CanvasSize = UDim2.new(0, 0, 0, 1500)

-- Chat input frame
local inputFrame = Instance.new("Frame")
inputFrame.Name = "InputFrame"
inputFrame.Size = UDim2.new(1, -20, 0, 35)
inputFrame.Position = UDim2.new(0, 10, 1, -40)
inputFrame.BackgroundColor3 = themes[currentTheme].secondary
inputFrame.BorderSizePixel = 0
inputFrame.Parent = contentFrame

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = inputFrame

local chatInput = Instance.new("TextBox")
chatInput.Name = "ChatInput"
chatInput.Size = UDim2.new(1, -60, 1, -8)
chatInput.Position = UDim2.new(0, 8, 0, 4)
chatInput.BackgroundTransparency = 1
chatInput.Text = ""
chatInput.PlaceholderText = "Nh·∫≠p l·ªánh ho·∫∑c script..."
chatInput.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
chatInput.TextColor3 = themes[currentTheme].text
chatInput.TextSize = 12
chatInput.TextXAlignment = Enum.TextXAlignment.Left
chatInput.Font = Enum.Font.Gotham
chatInput.ClearTextOnFocus = false
chatInput.Parent = inputFrame

local sendButton = Instance.new("TextButton")
sendButton.Name = "SendButton"
sendButton.Size = UDim2.new(0, 45, 0, 27)
sendButton.Position = UDim2.new(1, -49, 0, 4)
sendButton.BackgroundColor3 = themes[currentTheme].accent
sendButton.BorderSizePixel = 0
sendButton.Text = "G·ª≠i"
sendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendButton.TextSize = 10
sendButton.Font = Enum.Font.GothamBold
sendButton.Parent = inputFrame

local sendCorner = Instance.new("UICorner")
sendCorner.CornerRadius = UDim.new(0, 4)
sendCorner.Parent = sendButton

-- H√†m c·∫≠p nh·∫≠t theme
local function updateTheme()
    mainFrame.BackgroundColor3 = themes[currentTheme].main
    titleBar.BackgroundColor3 = themes[currentTheme].secondary
    titleText.TextColor3 = themes[currentTheme].text
    outputFrame.BackgroundColor3 = themes[currentTheme].output
    helpFrame.BackgroundColor3 = themes[currentTheme].help
    helpText.TextColor3 = themes[currentTheme].text
    inputFrame.BackgroundColor3 = themes[currentTheme].secondary
    chatInput.TextColor3 = themes[currentTheme].text
    sendButton.BackgroundColor3 = themes[currentTheme].accent
    
    -- RGB animation
    if currentTheme == "rgb" then
        spawn(function()
            while currentTheme == "rgb" do
                for i = 0, 1, 0.01 do
                    if currentTheme ~= "rgb" then break end
                    local r = math.sin(i * math.pi * 2) * 0.5 + 0.5
                    local g = math.sin((i + 0.33) * math.pi * 2) * 0.5 + 0.5
                    local b = math.sin((i + 0.66) * math.pi * 2) * 0.5 + 0.5
                    
                    titleBar.BackgroundColor3 = Color3.fromRGB(r * 100 + 50, g * 100 + 50, b * 100 + 50)
                    sendButton.BackgroundColor3 = Color3.fromRGB(r * 255, g * 255, b * 255)
                    wait(0.1)
                end
            end
        end)
    end
end

-- H√†m th√™m tin nh·∫Øn
local function addMessage(message, color)
    local msgFrame = Instance.new("Frame")
    msgFrame.Size = UDim2.new(1, -5, 0, 16)
    msgFrame.BackgroundTransparency = 1
    msgFrame.Parent = outputScroll
    
    local msgText = Instance.new("TextLabel")
    msgText.Size = UDim2.new(1, 0, 1, 0)
    msgText.BackgroundTransparency = 1
    msgText.Text = message
    msgText.TextColor3 = color or themes[currentTheme].text
    msgText.TextSize = 10
    msgText.TextXAlignment = Enum.TextXAlignment.Left
    msgText.Font = Enum.Font.Gotham
    msgText.TextWrapped = true
    msgText.Parent = msgFrame
    
    outputScroll.CanvasSize = UDim2.new(0, 0, 0, outputLayout.AbsoluteContentSize.Y + 5)
    outputScroll.CanvasPosition = Vector2.new(0, outputScroll.CanvasSize.Y.Offset)
end

-- C√°c h√†m x·ª≠ l√Ω l·ªánh c∆° b·∫£n (gi·ªØ nguy√™n)
local function setSpeed(speed)
    local num = tonumber(speed)
    if num and player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = num
        addMessage("üèÉ T·ªëc ƒë·ªô: " .. num, Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function resetSpeed()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = originalWalkSpeed
        addMessage("‚úÖ Reset t·ªëc ƒë·ªô: " .. originalWalkSpeed, Color3.fromRGB(100, 255, 100))
    end
end

local function setJump(power)
    local num = tonumber(power)
    if num and player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.JumpPower = num
        addMessage("ü¶ò S·ª©c nh·∫£y: " .. num, Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function resetJump()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.JumpPower = originalJumpPower
        addMessage("‚úÖ Reset s·ª©c nh·∫£y: " .. originalJumpPower, Color3.fromRGB(100, 255, 100))
    end
end

-- Teleport to player
local function teleportToPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) or string.lower(p.DisplayName):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
            addMessage("üìç ƒê√£ teleport ƒë·∫øn " .. targetPlayer.Name, Color3.fromRGB(100, 255, 100))
        end
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

-- Anti Kick/Ban
local function startAntiKick()
    if isAntiKick then 
        addMessage("‚ö†Ô∏è Anti Kick ƒë√£ b·∫≠t!", Color3.fromRGB(255, 200, 100))
        return 
    end
    
    isAntiKick = true
    addMessage("üõ°Ô∏è B·∫≠t Anti Kick/Ban", Color3.fromRGB(100, 255, 100))
    
    local oldNamecall = nil
    oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
        if isAntiKick and getnamecallmethod() == "Kick" then
            return
        end
        return oldNamecall(self, ...)
    end)
end

local function stopAntiKick()
    isAntiKick = false
    addMessage("‚úÖ T·∫Øt Anti Kick", Color3.fromRGB(100, 255, 100))
end

-- Player Control Functions
local function freezePlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) or string.lower(p.DisplayName):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local anchor = Instance.new("BodyPosition", targetPlayer.Character.HumanoidRootPart)
        anchor.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        anchor.Position = targetPlayer.Character.HumanoidRootPart.Position
        addMessage("üßä ƒê√£ ƒë√≥ng bƒÉng " .. targetPlayer.Name, Color3.fromRGB(100, 200, 255))
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function unfreezePlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) or string.lower(p.DisplayName):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        for _, obj in pairs(targetPlayer.Character.HumanoidRootPart:GetChildren()) do
            if obj:IsA("BodyPosition") then
                obj:Destroy()
            end
        end
        addMessage("üî• ƒê√£ b·ªè ƒë√≥ng bƒÉng " .. targetPlayer.Name, Color3.fromRGB(255, 150, 100))
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function bringPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) or string.lower(p.DisplayName):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            targetPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
            addMessage("üéØ ƒê√£ k√©o " .. targetPlayer.Name .. " v·ªÅ", Color3.fromRGB(255, 200, 100))
        end
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function gotoPlayer(targetName)
    teleportToPlayer(targetName) -- S·ª≠ d·ª•ng l·∫°i function tp
end

local function viewPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) or string.lower(p.DisplayName):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer then
        workspace.CurrentCamera.CameraSubject = targetPlayer.Character
        addMessage("üëÅÔ∏è ƒêang xem " .. targetPlayer.Name, Color3.fromRGB(100, 255, 255))
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi ch∆°i: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function unviewPlayer()
    workspace.CurrentCamera.CameraSubject = player.Character
    addMessage("üëÅÔ∏è ƒê√£ tr·ªü v·ªÅ camera b√¨nh th∆∞·ªùng", Color3.fromRGB(100, 255, 100))
end

-- Character Mods Functions
local function setBigHead()
    if player.Character and player.Character:FindFirstChild("Head") then
        player.Character.Head.Size = Vector3.new(5, 5, 5)
        addMessage("ü§ï ƒê√£ l√†m ƒë·∫ßu to", Color3.fromRGB(255, 200, 100))
    end
end

local function setSmallHead()
    if player.Character and player.Character:FindFirstChild("Head") then
        player.Character.Head.Size = Vector3.new(0.5, 0.5, 0.5)
        addMessage("ü§è ƒê√£ l√†m ƒë·∫ßu nh·ªè", Color3.fromRGB(100, 255, 200))
    end
end

local function resetHead()
    if player.Character and player.Character:FindFirstChild("Head") then
        player.Character.Head.Size = Vector3.new(2, 1, 1)
        addMessage("‚úÖ ƒê√£ reset k√≠ch th∆∞·ªõc ƒë·∫ßu", Color3.fromRGB(100, 255, 100))
    end
end

local function startSpin()
    if isSpin then 
        addMessage("‚ö†Ô∏è Spin ƒë√£ b·∫≠t!", Color3.fromRGB(255, 200, 100))
        return 
    end
    
    isSpin = true
    addMessage("üåÄ B·∫≠t quay tr√≤n", Color3.fromRGB(100, 255, 100))
    
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local spin = Instance.new("BodyAngularVelocity", player.Character.HumanoidRootPart)
        spin.MaxTorque = Vector3.new(0, math.huge, 0)
        spin.AngularVelocity = Vector3.new(0, 20, 0)
        
        spinConnection = RunService.Heartbeat:Connect(function()
            if not isSpin or not spin.Parent then
                if spin then spin:Destroy() end
                if spinConnection then spinConnection:Disconnect() end
            end
        end)
    end
end

local function stopSpin()
    isSpin = false
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, obj in pairs(player.Character.HumanoidRootPart:GetChildren()) do
            if obj:IsA("BodyAngularVelocity") then
                obj:Destroy()
            end
        end
    end
    if spinConnection then spinConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt quay tr√≤n", Color3.fromRGB(100, 255, 100))
end

local function startDance()
    if isDance then 
        addMessage("‚ö†Ô∏è Dance ƒë√£ b·∫≠t!", Color3.fromRGB(255, 200, 100))
        return 
    end
    
    isDance = true
    addMessage("üíÉ B·∫≠t nh·∫£y m√∫a", Color3.fromRGB(255, 100, 255))
    
    danceConnection = RunService.Heartbeat:Connect(function()
        if isDance and player.Character and player.Character:FindFirstChild("Humanoid") then
            local dances = {"507771019", "507776043", "507777268", "507777451"}
            local randomDance = dances[math.random(1, #dances)]
            player.Character.Humanoid:LoadAnimation(Instance.new("Animation", player.Character.Humanoid)).AnimationId = "rbxassetid://" .. randomDance
            wait(2)
        end
    end)
end

local function stopDance()
    isDance = false
    if danceConnection then danceConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt nh·∫£y m√∫a", Color3.fromRGB(100, 255, 100))
end

-- Exploits Functions
local function setGravity(value)
    local num = tonumber(value)
    if num then
        workspace.Gravity = num
        addMessage("üåç Tr·ªçng l·ª±c: " .. num, Color3.fromRGB(150, 255, 150))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

-- Utilities Functions
local function copyPlaceId()
    setclipboard(tostring(game.PlaceId))
    addMessage("üìã ƒê√£ copy Place ID: " .. game.PlaceId, Color3.fromRGB(100, 255, 100))
end

local function copyJobId()
    setclipboard(game.JobId)
    addMessage("üìã ƒê√£ copy Job ID", Color3.fromRGB(100, 255, 100))
end

local function showTime()
    local time = os.date("%H:%M:%S - %d/%m/%Y")
    addMessage("üïê Th·ªùi gian: " .. time, Color3.fromRGB(255, 255, 100))
end

local function showPing()
    local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString()
    addMessage("üì° Ping: " .. ping, Color3.fromRGB(100, 255, 255))
end

-- Visual Effects Functions
local function startRainbow()
    if isRainbow then 
        addMessage("‚ö†Ô∏è Rainbow ƒë√£ b·∫≠t!", Color3.fromRGB(255, 200, 100))
        return 
    end
    
    isRainbow = true
    addMessage("üåà B·∫≠t hi·ªáu ·ª©ng rainbow", Color3.fromRGB(255, 100, 255))
    
    rainbowConnection = RunService.Heartbeat:Connect(function()
        if isRainbow and player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    local hue = tick() * 2 % 1
                    part.Color = Color3.fromHSV(hue, 1, 1)
                end
            end
        end
    end)
end

local function stopRainbow()
    isRainbow = false
    if rainbowConnection then rainbowConnection:Disconnect() end
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Color = Color3.fromRGB(163, 162, 165) -- Default color
            end
        end
    end
    addMessage("‚úÖ T·∫Øt hi·ªáu ·ª©ng rainbow", Color3.fromRGB(100, 255, 100))
end

local function addSparkles()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                if not part:FindFirstChild("Sparkles") then
                    Instance.new("Sparkles", part)
                end
            end
        end
        addMessage("‚ú® ƒê√£ th√™m hi·ªáu ·ª©ng l·∫•p l√°nh", Color3.fromRGB(255, 255, 100))
    end
end

local function removeSparkles()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") then
                for _, effect in pairs(part:GetChildren()) do
                    if effect:IsA("Sparkles") then
                        effect:Destroy()
                    end
                end
            end
        end
        addMessage("‚úÖ ƒê√£ x√≥a hi·ªáu ·ª©ng l·∫•p l√°nh", Color3.fromRGB(100, 255, 100))
    end
end

local function addFire()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not player.Character.HumanoidRootPart:FindFirstChild("Fire") then
            Instance.new("Fire", player.Character.HumanoidRootPart)
        end
        addMessage("üî• ƒê√£ th√™m hi·ªáu ·ª©ng l·ª≠a", Color3.fromRGB(255, 100, 100))
    end
end

local function removeFire()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, effect in pairs(player.Character.HumanoidRootPart:GetChildren()) do
            if effect:IsA("Fire") then
                effect:Destroy()
            end
        end
        addMessage("‚úÖ ƒê√£ x√≥a hi·ªáu ·ª©ng l·ª≠a", Color3.fromRGB(100, 255, 100))
    end
end

local function addSmoke()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not player.Character.HumanoidRootPart:FindFirstChild("Smoke") then
            Instance.new("Smoke", player.Character.HumanoidRootPart)
        end
        addMessage("üí® ƒê√£ th√™m hi·ªáu ·ª©ng kh√≥i", Color3.fromRGB(150, 150, 150))
    end
end

local function removeSmoke()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, effect in pairs(player.Character.HumanoidRootPart:GetChildren()) do
            if effect:IsA("Smoke") then
                effect:Destroy()
            end
        end
        addMessage("‚úÖ ƒê√£ x√≥a hi·ªáu ·ª©ng kh√≥i", Color3.fromRGB(100, 255, 100))
    end
end

-- Auto Clicker
local function startAutoClicker()
    if isAutoClicker then 
        addMessage("‚ö†Ô∏è Auto Clicker ƒë√£ b·∫≠t!", Color3.fromRGB(255, 200, 100))
        return 
    end
    
    isAutoClicker = true
    addMessage("üñ±Ô∏è B·∫≠t Auto Clicker", Color3.fromRGB(100, 255, 100))
    
    autoClickConnection = RunService.Heartbeat:Connect(function()
        if isAutoClicker then
            mouse1click()
            wait(0.01)
        end
    end)
end

local function stopAutoClicker()
    isAutoClicker = false
    if autoClickConnection then
        autoClickConnection:Disconnect()
    end
    addMessage("‚úÖ T·∫Øt Auto Clicker", Color3.fromRGB(100, 255, 100))
end

-- Server Info
local function showServerInfo()
    local playerCount = #Players:GetPlayers()
    local gameId = game.GameId
    local placeId = game.PlaceId
    local jobId = game.JobId
    
    addMessage("üåê === TH√îNG TIN SERVER ===", Color3.fromRGB(100, 200, 255))
    addMessage("üë• Ng∆∞·ªùi ch∆°i: " .. playerCount .. "/" .. Players.MaxPlayers, Color3.fromRGB(255, 255, 100))
    addMessage("üéÆ Game ID: " .. gameId, Color3.fromRGB(255, 255, 100))
    addMessage("üìç Place ID: " .. placeId, Color3.fromRGB(255, 255, 100))
    addMessage("üîó Job ID: " .. jobId:sub(1, 8) .. "...", Color3.fromRGB(255, 255, 100))
end

-- Rejoin
local function rejoinServer()
    addMessage("üîÑ ƒêang v√†o l·∫°i server...", Color3.fromRGB(100, 255, 100))
    TeleportService:Teleport(game.PlaceId, player)
end

-- Server Hop
local function serverHop()
    addMessage("üåê ƒêang t√¨m server m·ªõi...", Color3.fromRGB(100, 255, 100))
    
    local servers = {}
    pcall(function()
        local req = game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100")
        local data = game:GetService("HttpService"):JSONDecode(req)
        
        if data.data then
            for _, server in pairs(data.data) do
                if server.id ~= game.JobId and server.playing < server.maxPlayers then
                    table.insert(servers, server.id)
                end
            end
        end
    end)
    
    if #servers > 0 then
        local randomServer = servers[math.random(1, #servers)]
        TeleportService:TeleportToPlaceInstance(game.PlaceId, randomServer, player)
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y server kh√°c!", Color3.fromRGB(255, 100, 100))
    end
end

-- C√°c h√†m kh√°c (Anti AFK, Inf Jump, Noclip) - gi·ªØ nguy√™n
local function startAntiAFK()
    if isAntiAFK then return end
    isAntiAFK = true
    addMessage("üõ°Ô∏è B·∫≠t Anti AFK", Color3.fromRGB(100, 255, 100))
    antiAFKConnection = RunService.Heartbeat:Connect(function()
        if isAntiAFK then
            pcall(function()
                game:GetService('VirtualUser'):CaptureController()
                game:GetService('VirtualUser'):ClickButton2(Vector2.new())
            end)
        end
    end)
end

local function stopAntiAFK()
    isAntiAFK = false
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt Anti AFK", Color3.fromRGB(100, 255, 100))
end

local function startInfJump()
    if isInfJump then return end
    isInfJump = true
    addMessage("üöÄ B·∫≠t Infinite Jump", Color3.fromRGB(100, 255, 100))
    infJumpConnection = UserInputService.JumpRequest:Connect(function()
        if isInfJump and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid:ChangeState("Jumping")
        end
    end)
end

local function stopInfJump()
    isInfJump = false
    if infJumpConnection then infJumpConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt Infinite Jump", Color3.fromRGB(100, 255, 100))
end

local function startNoclip()
    if isNoclip then return end
    isNoclip = true
    addMessage("üëª B·∫≠t noclip", Color3.fromRGB(100, 255, 100))
    noclipConnection = RunService.Stepped:Connect(function()
        if isNoclip and player.Character then
            for _,v in pairs(player.Character:GetChildren()) do
                if v:IsA('BasePart') then v.CanCollide = false end
            end
        end
    end)
end

local function stopNoclip()
    isNoclip = false
    if noclipConnection then noclipConnection:Disconnect() end
    if player.Character then
        for _,v in pairs(player.Character:GetChildren()) do
            if v:IsA('BasePart') then v.CanCollide = true end
        end
    end
    addMessage("‚úÖ T·∫Øt noclip", Color3.fromRGB(100, 255, 100))
end

-- Script loaders
local function loadScript(scriptName, url)
    pcall(function()
        loadstring(game:HttpGet(url))()
        addMessage("‚ö° ƒê√£ t·∫£i " .. scriptName, Color3.fromRGB(100, 255, 100))
    end)
end

-- X·ª≠ l√Ω l·ªánh
local function processCommand(input)
    local args = string.split(string.lower(input), " ")
    local command = args[1]
    
    addMessage("> " .. input, Color3.fromRGB(150, 150, 255))
    
    -- Basic commands
    if command == "speed" and args[2] then setSpeed(args[2])
    elseif command == "unspeed" then resetSpeed()
    elseif command == "jump" and args[2] then setJump(args[2])
    elseif command == "unjump" then resetJump()
    elseif command == "fly" then loadScript("Vehicle Fly GUI", "https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Vehicle%20Fly%20Gui")
    elseif command == "noclip" then startNoclip()
    elseif command == "unnoclip" then stopNoclip()
    elseif command == "antiafk" then startAntiAFK()
    elseif command == "unantiafk" then stopAntiAFK()
    elseif command == "infjump" then startInfJump()
    elseif command == "uninfjump" then stopInfJump()
    elseif command == "reset" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
            addMessage("üîÑ Reset nh√¢n v·∫≠t", Color3.fromRGB(100, 255, 100))
        end
    elseif command == "clear" then
        for _,child in pairs(outputScroll:GetChildren()) do
            if child:IsA("Frame") then child:Destroy() end
        end
        outputScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    -- New commands
    elseif command == "tp" and args[2] then teleportToPlayer(args[2])
    elseif command == "antikick" then startAntiKick()
    elseif command == "unantikick" then stopAntiKick()
    elseif command == "autoclick" then startAutoClicker()
    elseif command == "unautoclick" then stopAutoClicker()
    elseif command == "serverinfo" then showServerInfo()
    elseif command == "rejoin" then rejoinServer()
    elseif command == "serverhop" then serverHop()
    elseif command == "theme" then
        if args[2] and themes[args[2]] then
            currentTheme = args[2]
            updateTheme()
            addMessage("üé® ƒê√£ ƒë·ªïi theme: " .. args[2], Color3.fromRGB(100, 255, 100))
        else
            addMessage("üé® Themes c√≥ s·∫µn: dark, light, rgb", Color3.fromRGB(255, 255, 100))
        end
    -- Player Control Commands
    elseif command == "freeze" and args[2] then freezePlayer(args[2])
    elseif command == "unfreeze" and args[2] then unfreezePlayer(args[2])
    elseif command == "bring" and args[2] then bringPlayer(args[2])
    elseif command == "goto" and args[2] then gotoPlayer(args[2])
    elseif command == "view" and args[2] then viewPlayer(args[2])
    elseif command == "unview" then unviewPlayer()
    -- Character Mods Commands
    elseif command == "bighead" then setBigHead()
    elseif command == "unbighead" then resetHead()
    elseif command == "smallhead" then setSmallHead()
    elseif command == "unsmallhead" then resetHead()
    elseif command == "spin" then startSpin()
    elseif command == "unspin" then stopSpin()
    elseif command == "dance" then startDance()
    elseif command == "undance" then stopDance()
    -- Exploits Commands
    elseif command == "walkspeed" and args[2] then setSpeed(args[2]) -- Alias
    elseif command == "jumpheight" and args[2] then setJump(args[2]) -- Alias
    elseif command == "gravity" and args[2] then setGravity(args[2])
    elseif command == "reach" and args[2] then
        addMessage("üéØ Reach hack ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn", Color3.fromRGB(255, 200, 100))
    -- Utilities Commands
    elseif command == "copyid" then copyPlaceId()
    elseif command == "copyjob" then copyJobId()
    elseif command == "time" then showTime()
    elseif command == "ping" then showPing()
    -- Visual Effects Commands
    elseif command == "rainbow" then startRainbow()
    elseif command == "unrainbow" then stopRainbow()
    elseif command == "sparkles" then addSparkles()
    elseif command == "unsparkles" then removeSparkles()
    elseif command == "fire" then addFire()
    elseif command == "unfire" then removeFire()
    elseif command == "smoke" then addSmoke()
    elseif command == "unsmoke" then removeSmoke()
    -- Script Hub Commands
    elseif command == "iy" then
        loadScript("Infinite Yield", "https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source")
    elseif command == "airflow" then
        loadScript("AirFlow", "https://api.luarmor.net/files/v3/loaders/255ac567ced3dcb9e69aa7e44c423f19.lua")
    elseif command == "h4x" then
        loadScript("H4X Scripts", "https://raw.githubusercontent.com/H4xScripts/Loader/refs/heads/main/loader.lua")
    elseif command == "r15" then
        loadScript("FE Emotes GUI", "https://gist.githubusercontent.com/RedZenXYZ/3da6af1961efa275de6c3c2a6dbace03/raw/bb027f99cec0ea48ef9c5eabfb9116ddff20633d/FE%2520Emotes%2520Gui")
    elseif command == "skull" then
        loadScript("Skull Hub", "https://raw.githubusercontent.com/hungquan99/SkullHub/main/loader.lua")
    elseif command == "nameless" then
        loadScript("Nameless Admin", "https://rawscripts.net/raw/Universal-Script-nameless-admin-15646")
    elseif command == "nathub" then
        loadScript("NatHub", "https://raw.githubusercontent.com/ArdyBotzz/NatHub/refs/heads/master/NatHub.lua")
    elseif command == "arceus" then
        loadScript("Arceus X V3", "https://raw.githubusercontent.com/AZYsGithub/chillz-workshop/main/Arceus%20X%20V3")
    elseif command == "shader" then
        loadScript("PShade Ultimate", "https://raw.githubusercontent.com/randomstring0/pshade-ultimate/refs/heads/main/src/cd.lua")
    elseif command == "native" then
        loadScript("Native Script", "https://getnative.cc/script/loader")
    elseif command == "nolag" then
        loadScript("No Lag Hub", "https://raw.githubusercontent.com/NoLag-id/No-Lag-HUB/refs/heads/main/Loader/LoaderV1.lua")
    elseif command == "micup" then
        loadScript("I Wanna Run Away", "https://raw.githubusercontent.com/0riginalWarrior/Stalkie/refs/heads/main/roblox.lua")
    elseif command == "speedhub" then
        loadScript("Speed Hub X", "https://rawscripts.net/raw/Grow-a-Garden-Speed-Hub-X-Keyless-38062")
    elseif command == "lunor" then
        loadScript("Lunor Hub", "https://lunor.dev/loader")
    elseif command == "thunderz" then
        loadScript("ThunderZ", "https://raw.githubusercontent.com/ThundarZ/Welcome/refs/heads/main/Main/GaG/Main.lua")
    else
        addMessage("‚ùå L·ªánh kh√¥ng t·ªìn t·∫°i!", Color3.fromRGB(255, 100, 100))
    end
end

-- S·ª± ki·ªán g·ª≠i l·ªánh
local function sendCommand()
    local input = chatInput.Text:gsub("^%s*(.-)%s*$", "%1")
    if input ~= "" then
        processCommand(input)
        chatInput.Text = ""
    end
end

sendButton.MouseButton1Click:Connect(sendCommand)
chatInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        sendCommand()
    end
end)

-- S·ª± ki·ªán theme button
themeButton.MouseButton1Click:Connect(function()
    local themeOrder = {"dark", "light", "rgb"}
    local currentIndex = 1
    
    for i, theme in ipairs(themeOrder) do
        if theme == currentTheme then
            currentIndex = i
            break
        end
    end
    
    local nextIndex = (currentIndex % #themeOrder) + 1
    currentTheme = themeOrder[nextIndex]
    updateTheme()
    addMessage("üé® Theme: " .. currentTheme, Color3.fromRGB(100, 255, 100))
end)

-- S·ª± ki·ªán minimize/maximize
minimizeButton.MouseButton1Click:Connect(function()
    if isMinimized then
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 600, 0, 380)})
        tween:Play()
        contentFrame.Visible = true
        minimizeButton.Text = "‚àí"
        isMinimized = false
    else
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 600, 0, 45)})
        tween:Play()
        contentFrame.Visible = false
        minimizeButton.Text = "+"
        isMinimized = true
    end
end)

-- S·ª± ki·ªán ƒë√≥ng
closeButton.MouseButton1Click:Connect(function()
    -- Cleanup connections
    if noclipConnection then noclipConnection:Disconnect() end
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    if infJumpConnection then infJumpConnection:Disconnect() end
    if autoClickConnection then autoClickConnection:Disconnect() end
    if spinConnection then spinConnection:Disconnect() end
    if danceConnection then danceConnection:Disconnect() end
    if rainbowConnection then rainbowConnection:Disconnect() end
    
    screenGui:Destroy()
end)

-- Ph√≠m t·∫Øt F1
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F1 then
        screenGui.Enabled = not screenGui.Enabled
    end
end)

-- D·ªçn d·∫πp khi character respawn
player.CharacterAdded:Connect(function()
    isNoclip = false
    isAntiAFK = false
    isInfJump = false
    isAutoClicker = false
    isSpin = false
    isDance = false
    isRainbow = false
    
    if noclipConnection then noclipConnection:Disconnect() end
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    if infJumpConnection then infJumpConnection:Disconnect() end
    if autoClickConnection then autoClickConnection:Disconnect() end
    if spinConnection then spinConnection:Disconnect() end
    if danceConnection then danceConnection:Disconnect() end
    if rainbowConnection then rainbowConnection:Disconnect() end
end)

-- Kh·ªüi t·∫°o theme
updateTheme()

-- Welcome messages
addMessage("üöÄ Ultimate Command Hub V3 s·∫µn s√†ng!", Color3.fromRGB(100, 255, 100))
addMessage("üéâ 40+ l·ªánh m·ªõi: freeze, bighead, rainbow, gravity...", Color3.fromRGB(200, 200, 255))
addMessage("üé® ƒê·ªïi theme: theme dark/light/rgb ho·∫∑c n√∫t üé®", Color3.fromRGB(255, 255, 100))

print("Ultimate Command Hub V3 loaded! Press F1 to toggle.")