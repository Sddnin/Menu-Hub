-- Advanced Player Functions
local followTarget = nil-- Ultimate Command Hub

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Bi·∫øn l∆∞u tr·∫°ng th√°i (ƒë√£ gi·∫£m)
local isNoclip = false
local isAntiAFK = false
local isInfJump = false
local isAutoClicker = false
local isSpin = false
local isRainbow = false
local isESP = false
local isFullbright = false
local isNoFog = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local originalFogEnd = nil
local originalGravity = 196.2
local isMinimized = false
local currentTheme = "dark"
local savedPosition = nil

-- Connections (ƒë√£ gi·∫£m)
local antiAFKConnection, infJumpConnection, noclipConnection, autoClickConnection
local spinConnection, rainbowConnection, espConnection

-- Themes
local themes = {
    dark = {
        main = Color3.fromRGB(25, 25, 25),
        secondary = Color3.fromRGB(40, 40, 40),
        accent = Color3.fromRGB(60, 120, 220),
        text = Color3.fromRGB(255, 255, 255),
        output = Color3.fromRGB(15, 15, 15),
        help = Color3.fromRGB(30, 30, 30)
    },
    light = {
        main = Color3.fromRGB(240, 240, 240),
        secondary = Color3.fromRGB(220, 220, 220),
        accent = Color3.fromRGB(70, 130, 250),
        text = Color3.fromRGB(0, 0, 0),
        output = Color3.fromRGB(255, 255, 255),
        help = Color3.fromRGB(230, 230, 230)
    },
    rgb = {
        main = Color3.fromRGB(50, 0, 50),
        secondary = Color3.fromRGB(80, 0, 80),
        accent = Color3.fromRGB(255, 0, 255),
        text = Color3.fromRGB(255, 255, 255),
        output = Color3.fromRGB(20, 0, 20),
        help = Color3.fromRGB(60, 0, 60)
    }
}

-- T·∫°o ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CommandUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Frame ch√≠nh
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 550, 0, 350)
mainFrame.Position = UDim2.new(0.5, -275, 0.5, -175)
mainFrame.BackgroundColor3 = themes[currentTheme].main
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Title bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.BackgroundColor3 = themes[currentTheme].secondary
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1, -100, 1, 0)
titleText.Position = UDim2.new(0, 15, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "üöÄ Command Hub "
titleText.TextColor3 = themes[currentTheme].text
titleText.TextSize = 16
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Font = Enum.Font.GothamBold
titleText.Parent = titleBar

-- Theme button
local themeButton = Instance.new("TextButton")
themeButton.Size = UDim2.new(0, 35, 0, 30)
themeButton.Position = UDim2.new(1, -100, 0, 5)
themeButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
themeButton.BorderSizePixel = 0
themeButton.Text = "üé®"
themeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
themeButton.TextSize = 16
themeButton.Font = Enum.Font.GothamBold
themeButton.Parent = titleBar

local themeCorner = Instance.new("UICorner")
themeCorner.CornerRadius = UDim.new(0, 6)
themeCorner.Parent = themeButton

-- Minimize button
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -60, 0, 5)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
minimizeButton.BorderSizePixel = 0
minimizeButton.Text = "‚àí"
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.TextSize = 16
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.Parent = titleBar

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 6)
minimizeCorner.Parent = minimizeButton

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -25, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
closeButton.BorderSizePixel = 0
closeButton.Text = "‚ùå"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 14
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeButton

-- Content frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, 0, 1, -40)
contentFrame.Position = UDim2.new(0, 0, 0, 40)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Chat output frame
local outputFrame = Instance.new("Frame")
outputFrame.Name = "OutputFrame"
outputFrame.Size = UDim2.new(0.55, -10, 1, -45)
outputFrame.Position = UDim2.new(0, 10, 0, 5)
outputFrame.BackgroundColor3 = themes[currentTheme].output
outputFrame.BorderSizePixel = 0
outputFrame.Parent = contentFrame

local outputCorner = Instance.new("UICorner")
outputCorner.CornerRadius = UDim.new(0, 8)
outputCorner.Parent = outputFrame

local outputScroll = Instance.new("ScrollingFrame")
outputScroll.Size = UDim2.new(1, -8, 1, -8)
outputScroll.Position = UDim2.new(0, 4, 0, 4)
outputScroll.BackgroundTransparency = 1
outputScroll.ScrollBarThickness = 4
outputScroll.ScrollBarImageColor3 = Color3.fromRGB(70, 70, 70)
outputScroll.Parent = outputFrame

local outputLayout = Instance.new("UIListLayout")
outputLayout.SortOrder = Enum.SortOrder.LayoutOrder
outputLayout.Padding = UDim.new(0, 2)
outputLayout.Parent = outputScroll

-- Help frame
local helpFrame = Instance.new("Frame")
helpFrame.Name = "HelpFrame"
helpFrame.Size = UDim2.new(0.45, -10, 1, -45)
helpFrame.Position = UDim2.new(0.55, 0, 0, 5)
helpFrame.BackgroundColor3 = themes[currentTheme].help
helpFrame.BorderSizePixel = 0
helpFrame.Parent = contentFrame

local helpCorner = Instance.new("UICorner")
helpCorner.CornerRadius = UDim.new(0, 8)
helpCorner.Parent = helpFrame

local helpScroll = Instance.new("ScrollingFrame")
helpScroll.Size = UDim2.new(1, -8, 1, -8)
helpScroll.Position = UDim2.new(0, 4, 0, 4)
helpScroll.BackgroundTransparency = 1
helpScroll.ScrollBarThickness = 4
helpScroll.ScrollBarImageColor3 = Color3.fromRGB(70, 70, 70)
helpScroll.Parent = helpFrame

local helpText = Instance.new("TextLabel")
helpText.Size = UDim2.new(1, -5, 0, 800)
helpText.Position = UDim2.new(0, 2, 0, 0)
helpText.BackgroundTransparency = 1
helpText.Text = [[üöÄ L·ªÜNH C∆† B·∫¢N :
speed [s·ªë] | unspeed - T·ªëc ƒë·ªô di chuy·ªÉn
jump [s·ªë] | unjump - S·ª©c nh·∫£y
fly - Vehicle Fly GUI  
noclip | unnoclip - Xuy√™n t∆∞·ªùng
antiafk | unantiafk - Ch·ªëng AFK
infjump | uninfjump - Nh·∫£y v√¥ h·∫°n
reset - L√†m m·ªõi nh√¢n v·∫≠t
clear - X√≥a chat

üë• PLAYER:
tp [t√™n] - Teleport ƒë·∫øn ng∆∞·ªùi ch∆°i
goto [t√™n] - ƒêi ƒë·∫øn ng∆∞·ªùi ch∆°i
view [t√™n] | unview - Xem camera

üéÆ CHARACTER:
spin | unspin - Quay tr√≤n nh√¢n v·∫≠t
sit | unsit - Ng·ªìi/ƒë·ª©ng
invisible | uninvisible - ·∫®n/hi·ªán
emote [id] - Ch∆°i emote theo ID
bighead | unbighead - ƒê·∫ßu to/nh·ªè

‚ö° EXPLOITS:
walkspeed [s·ªë] - Alias cho speed
jumpheight [s·ªë] - Alias cho jump
gravity [s·ªë] | ungravity - Thay ƒë·ªïi/reset tr·ªçng l·ª±c
esp | unesp - Nh√¨n xuy√™n t∆∞·ªùng
fullbright | unfullbright - S√°ng t·ªëi ƒëa
nofog | fog - X√≥a/th√™m x∆∞∆°ng m√π
autoclick | unautoclick - Auto clicker

üîß UTILITIES:
copyid - Copy Place ID
copyjob - Copy Job ID  
time - Hi·ªÉn th·ªã th·ªùi gian
ping - Hi·ªÉn th·ªã ping
players - Danh s√°ch ng∆∞·ªùi ch∆°i
walkto [x] [y] [z] - ƒêi ƒë·∫øn t·ªça ƒë·ªô
getpos - L·∫•y v·ªã tr√≠ hi·ªán t·∫°i
savepos | loadpos - L∆∞u/t·∫£i v·ªã tr√≠
serverinfo - Th√¥ng tin server
rejoin - V√†o l·∫°i server

üé® VISUAL:
rainbow | unrainbow - ƒê·ªïi m√†u
sparkles | unsparkles - L·∫•p l√°nh
fire | unfire - Hi·ªáu ·ª©ng l·ª≠a
smoke | unsmoke - Hi·ªáu ·ª©ng kh√≥i
trail | untrail - Hi·ªáu ·ª©ng ƒëu√¥i
glow | unglow - Ph√°t s√°ng

‚ö° SCRIPT HUB:
cilent - Menu Hub Client
music - Music Hub
graphics - Graphics Hub
paint - Paint Hub
v1 - Sddnin V1
v15 - Sddnin V1.5
v2 - Sddnin V2

üé® THEMES: dark, light, rgb]]
helpText.TextColor3 = themes[currentTheme].text
helpText.TextSize = 9
helpText.TextXAlignment = Enum.TextXAlignment.Left
helpText.TextYAlignment = Enum.TextYAlignment.Top
helpText.Font = Enum.Font.Gotham
helpText.TextWrapped = true
helpText.Parent = helpScroll

helpScroll.CanvasSize = UDim2.new(0, 0, 0, 800)

-- Chat input frame
local inputFrame = Instance.new("Frame")
inputFrame.Name = "InputFrame"
inputFrame.Size = UDim2.new(1, -20, 0, 35)
inputFrame.Position = UDim2.new(0, 10, 1, -40)
inputFrame.BackgroundColor3 = themes[currentTheme].secondary
inputFrame.BorderSizePixel = 0
inputFrame.Parent = contentFrame

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = inputFrame

local chatInput = Instance.new("TextBox")
chatInput.Name = "ChatInput"
chatInput.Size = UDim2.new(1, -60, 1, -8)
chatInput.Position = UDim2.new(0, 8, 0, 4)
chatInput.BackgroundTransparency = 1
chatInput.Text = ""
chatInput.PlaceholderText = "Nh·∫≠p l·ªánh..."
chatInput.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
chatInput.TextColor3 = themes[currentTheme].text
chatInput.TextSize = 12
chatInput.TextXAlignment = Enum.TextXAlignment.Left
chatInput.Font = Enum.Font.Gotham
chatInput.ClearTextOnFocus = false
chatInput.Parent = inputFrame

local sendButton = Instance.new("TextButton")
sendButton.Name = "SendButton"
sendButton.Size = UDim2.new(0, 45, 0, 27)
sendButton.Position = UDim2.new(1, -49, 0, 4)
sendButton.BackgroundColor3 = themes[currentTheme].accent
sendButton.BorderSizePixel = 0
sendButton.Text = "G·ª≠i"
sendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendButton.TextSize = 10
sendButton.Font = Enum.Font.GothamBold
sendButton.Parent = inputFrame

local sendCorner = Instance.new("UICorner")
sendCorner.CornerRadius = UDim.new(0, 4)
sendCorner.Parent = sendButton

-- H√†m c·∫≠p nh·∫≠t theme
local function updateTheme()
    mainFrame.BackgroundColor3 = themes[currentTheme].main
    titleBar.BackgroundColor3 = themes[currentTheme].secondary
    titleText.TextColor3 = themes[currentTheme].text
    outputFrame.BackgroundColor3 = themes[currentTheme].output
    helpFrame.BackgroundColor3 = themes[currentTheme].help
    helpText.TextColor3 = themes[currentTheme].text
    inputFrame.BackgroundColor3 = themes[currentTheme].secondary
    chatInput.TextColor3 = themes[currentTheme].text
    sendButton.BackgroundColor3 = themes[currentTheme].accent
    
    -- RGB animation
    if currentTheme == "rgb" then
        spawn(function()
            while currentTheme == "rgb" do
                for i = 0, 1, 0.01 do
                    if currentTheme ~= "rgb" then break end
                    local r = math.sin(i * math.pi * 2) * 0.5 + 0.5
                    local g = math.sin((i + 0.33) * math.pi * 2) * 0.5 + 0.5
                    local b = math.sin((i + 0.66) * math.pi * 2) * 0.5 + 0.5
                    
                    titleBar.BackgroundColor3 = Color3.fromRGB(r * 100 + 50, g * 100 + 50, b * 100 + 50)
                    sendButton.BackgroundColor3 = Color3.fromRGB(r * 255, g * 255, b * 255)
                    wait(0.1)
                end
            end
        end)
    end
end

-- H√†m th√™m tin nh·∫Øn
local function addMessage(message, color)
    local msgFrame = Instance.new("Frame")
    msgFrame.Size = UDim2.new(1, -5, 0, 16)
    msgFrame.BackgroundTransparency = 1
    msgFrame.Parent = outputScroll
    
    local msgText = Instance.new("TextLabel")
    msgText.Size = UDim2.new(1, 0, 1, 0)
    msgText.BackgroundTransparency = 1
    msgText.Text = message
    msgText.TextColor3 = color or themes[currentTheme].text
    msgText.TextSize = 10
    msgText.TextXAlignment = Enum.TextXAlignment.Left
    msgText.Font = Enum.Font.Gotham
    msgText.TextWrapped = true
    msgText.Parent = msgFrame
    
    outputScroll.CanvasSize = UDim2.new(0, 0, 0, outputLayout.AbsoluteContentSize.Y + 5)
    outputScroll.CanvasPosition = Vector2.new(0, outputScroll.CanvasSize.Y.Offset)
end

-- C√ÅC H√ÄM X·ª¨ L√ù L·ªÜNH (CH·ªà GI·ªÆ NH·ªÆNG L·ªÜNH HO·∫†T ƒê·ªòNG 100%)

-- Basic Functions
local function setSpeed(speed)
    local num = tonumber(speed)
    if num and player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = num
        addMessage("üèÉ T·ªëc ƒë·ªô: " .. num, Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function resetSpeed()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = originalWalkSpeed
        addMessage("‚úÖ Reset t·ªëc ƒë·ªô", Color3.fromRGB(100, 255, 100))
    end
end

local function setJump(power)
    local num = tonumber(power)
    if num and player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.JumpPower = num
        addMessage("ü¶ò S·ª©c nh·∫£y: " .. num, Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function resetJump()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.JumpPower = originalJumpPower
        addMessage("‚úÖ Reset s·ª©c nh·∫£y", Color3.fromRGB(100, 255, 100))
    end
end

-- Noclip
local function startNoclip()
    if isNoclip then return end
    isNoclip = true
    addMessage("üëª B·∫≠t noclip", Color3.fromRGB(100, 255, 100))
    
    noclipConnection = RunService.Stepped:Connect(function()
        if isNoclip and player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA('BasePart') then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function stopNoclip()
    isNoclip = false
    if noclipConnection then noclipConnection:Disconnect() end
    
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA('BasePart') then
                part.CanCollide = true
            end
        end
    end
    addMessage("‚úÖ T·∫Øt noclip", Color3.fromRGB(100, 255, 100))
end

-- Anti AFK
local function startAntiAFK()
    if isAntiAFK then return end
    isAntiAFK = true
    addMessage("üõ°Ô∏è B·∫≠t Anti AFK", Color3.fromRGB(100, 255, 100))
    
    antiAFKConnection = RunService.Heartbeat:Connect(function()
        if isAntiAFK then
            pcall(function()
                game:GetService('VirtualUser'):CaptureController()
                game:GetService('VirtualUser'):ClickButton2(Vector2.new())
            end)
        end
    end)
end

local function stopAntiAFK()
    isAntiAFK = false
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt Anti AFK", Color3.fromRGB(100, 255, 100))
end

-- Infinite Jump
local function startInfJump()
    if isInfJump then return end
    isInfJump = true
    addMessage("üöÄ B·∫≠t Infinite Jump", Color3.fromRGB(100, 255, 100))
    
    infJumpConnection = UserInputService.JumpRequest:Connect(function()
        if isInfJump and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid:ChangeState("Jumping")
        end
    end)
end

local function stopInfJump()
    isInfJump = false
    if infJumpConnection then infJumpConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt Infinite Jump", Color3.fromRGB(100, 255, 100))
end

-- Player Functions
local function teleportToPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
            addMessage("üìç Teleport ƒë·∫øn " .. targetPlayer.Name, Color3.fromRGB(100, 255, 100))
        end
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function killPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
        targetPlayer.Character.Humanoid.Health = 0
        addMessage("üíÄ ƒê√£ gi·∫øt " .. targetPlayer.Name, Color3.fromRGB(255, 100, 100))
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function viewPlayer(targetName)
    local targetPlayer = nil
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(string.lower(targetName)) then
            targetPlayer = p
            break
        end
    end
    
    if targetPlayer then
        workspace.CurrentCamera.CameraSubject = targetPlayer.Character
        addMessage("üëÅÔ∏è Xem " .. targetPlayer.Name, Color3.fromRGB(100, 255, 255))
    else
        addMessage("‚ùå Kh√¥ng t√¨m th·∫•y: " .. targetName, Color3.fromRGB(255, 100, 100))
    end
end

local function unviewPlayer()
    workspace.CurrentCamera.CameraSubject = player.Character
    addMessage("üëÅÔ∏è Tr·ªü v·ªÅ camera b√¨nh th∆∞·ªùng", Color3.fromRGB(100, 255, 100))
end

-- Character Functions
local function startSpin()
    if isSpin then return end
    isSpin = true
    addMessage("üåÄ B·∫≠t quay tr√≤n", Color3.fromRGB(100, 255, 100))
    
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local spin = Instance.new("BodyAngularVelocity")
        spin.MaxTorque = Vector3.new(0, math.huge, 0)
        spin.AngularVelocity = Vector3.new(0, 20, 0)
        spin.Parent = player.Character.HumanoidRootPart
        
        spinConnection = RunService.Heartbeat:Connect(function()
            if not isSpin then
                if spin and spin.Parent then spin:Destroy() end
                if spinConnection then spinConnection:Disconnect() end
            end
        end)
    end
end

local function stopSpin()
    isSpin = false
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, obj in pairs(player.Character.HumanoidRootPart:GetChildren()) do
            if obj:IsA("BodyAngularVelocity") then
                obj:Destroy()
            end
        end
    end
    addMessage("‚úÖ T·∫Øt quay tr√≤n", Color3.fromRGB(100, 255, 100))
end

local function sitPlayer()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.Sit = true
        addMessage("ü™ë Ng·ªìi", Color3.fromRGB(100, 255, 100))
    end
end

local function standPlayer()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.Sit = false
        addMessage("üö∂ ƒê·ª©ng", Color3.fromRGB(100, 255, 100))
    end
end

local function setInvisible()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA('BasePart') and part.Name ~= "HumanoidRootPart" then
                part.Transparency = 1
            elseif part:IsA('Accessory') and part:FindFirstChild("Handle") then
                part.Handle.Transparency = 1
            end
        end
        if player.Character:FindFirstChild("Head") and player.Character.Head:FindFirstChild("face") then
            player.Character.Head.face.Transparency = 1
        end
        addMessage("üëª ·∫®n nh√¢n v·∫≠t", Color3.fromRGB(100, 255, 100))
    end
end

local function setVisible()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA('BasePart') and part.Name ~= "HumanoidRootPart" then
                part.Transparency = 0
            elseif part:IsA('Accessory') and part:FindFirstChild("Handle") then
                part.Handle.Transparency = 0
            end
        end
        if player.Character:FindFirstChild("Head") and player.Character.Head:FindFirstChild("face") then
            player.Character.Head.face.Transparency = 0
        end
        addMessage("‚úÖ Hi·ªán nh√¢n v·∫≠t", Color3.fromRGB(100, 255, 100))
    end
end

local function playEmote(emoteId)
    local id = tonumber(emoteId)
    if id and player.Character and player.Character:FindFirstChild("Humanoid") then
        pcall(function()
            local animation = Instance.new("Animation")
            animation.AnimationId = "rbxassetid://" .. id
            local animTrack = player.Character.Humanoid:LoadAnimation(animation)
            animTrack:Play()
            addMessage("üíÉ Emote: " .. id, Color3.fromRGB(255, 100, 255))
        end)
    else
        addMessage("‚ùå ID kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function setBigHead()
    if player.Character and player.Character:FindFirstChild("Head") then
        player.Character.Head.Size = Vector3.new(4, 4, 4)
        addMessage("ü§ï ƒê·∫ßu to", Color3.fromRGB(255, 200, 100))
    end
end

local function resetHead()
    if player.Character and player.Character:FindFirstChild("Head") then
        player.Character.Head.Size = Vector3.new(2, 1, 1)
        addMessage("‚úÖ Reset ƒë·∫ßu", Color3.fromRGB(100, 255, 100))
    end
end

-- Exploit Functions
local function setGravity(value)
    local num = tonumber(value)
    if num then
        workspace.Gravity = num
        addMessage("üåç Tr·ªçng l·ª±c: " .. num, Color3.fromRGB(150, 255, 150))
    else
        addMessage("‚ùå S·ªë kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function startESP()
    if isESP then return end
    isESP = true
    addMessage("üëª B·∫≠t ESP", Color3.fromRGB(100, 255, 255))
    
    espConnection = RunService.Heartbeat:Connect(function()
        if isESP then
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    local highlight = otherPlayer.Character:FindFirstChild("ESPHighlight")
                    if not highlight then
                        highlight = Instance.new("Highlight")
                        highlight.Name = "ESPHighlight"
                        highlight.FillColor = Color3.fromRGB(255, 0, 0)
                        highlight.OutlineColor = Color3.fromRGB(255, 255, 0)
                        highlight.Parent = otherPlayer.Character
                    end
                end
            end
        end
    end)
end

local function stopESP()
    isESP = false
    if espConnection then espConnection:Disconnect() end
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer.Character then
            local highlight = otherPlayer.Character:FindFirstChild("ESPHighlight")
            if highlight then highlight:Destroy() end
        end
    end
    addMessage("‚úÖ T·∫Øt ESP", Color3.fromRGB(100, 255, 100))
end

local function startFullbright()
    if isFullbright then return end
    isFullbright = true
    addMessage("üí° B·∫≠t Fullbright", Color3.fromRGB(255, 255, 100))
    
    game.Lighting.Brightness = 2
    game.Lighting.ClockTime = 14
    game.Lighting.FogEnd = 100000
    game.Lighting.GlobalShadows = false
    game.Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
end

local function stopFullbright()
    isFullbright = false
    addMessage("‚úÖ T·∫Øt Fullbright", Color3.fromRGB(100, 255, 100))
    
    game.Lighting.Brightness = 1
    game.Lighting.ClockTime = 8
    game.Lighting.FogEnd = originalFogEnd or 100000
    game.Lighting.GlobalShadows = true
    game.Lighting.OutdoorAmbient = Color3.fromRGB(70, 70, 70)
end

-- No Fog Function
local function removefog()
    if isNoFog then return end
    isNoFog = true
    
    -- Save original fog settings
    originalFogEnd = game.Lighting.FogEnd
    
    -- Remove fog
    game.Lighting.FogEnd = 100000000
    game.Lighting.FogStart = 100000000
    
    addMessage("üå´Ô∏è ƒê√£ x√≥a x∆∞∆°ng m√π", Color3.fromRGB(100, 255, 255))
end

local function addFog()
    isNoFog = false
    
    -- Restore original fog
    game.Lighting.FogEnd = originalFogEnd or 100000
    game.Lighting.FogStart = 0
    
    addMessage("‚úÖ ƒê√£ th√™m l·∫°i x∆∞∆°ng m√π", Color3.fromRGB(100, 255, 100))
end

local function startAutoClicker()
    if isAutoClicker then return end
    isAutoClicker = true
    addMessage("üñ±Ô∏è B·∫≠t Auto Clicker", Color3.fromRGB(100, 255, 100))
    
    autoClickConnection = RunService.Heartbeat:Connect(function()
        if isAutoClicker then
            pcall(function()
                mouse1click()
            end)
            wait(0.01)
        end
    end)
end

local function stopAutoClicker()
    isAutoClicker = false
    if autoClickConnection then autoClickConnection:Disconnect() end
    addMessage("‚úÖ T·∫Øt Auto Clicker", Color3.fromRGB(100, 255, 100))
end

-- Utility Functions
local function copyPlaceId()
    pcall(function()
        setclipboard(tostring(game.PlaceId))
        addMessage("üìã Copy Place ID: " .. game.PlaceId, Color3.fromRGB(100, 255, 100))
    end)
end

local function copyJobId()
    pcall(function()
        setclipboard(game.JobId)
        addMessage("üìã Copy Job ID", Color3.fromRGB(100, 255, 100))
    end)
end

local function showTime()
    local time = os.date("%H:%M:%S - %d/%m/%Y")
    addMessage("üïê Th·ªùi gian: " .. time, Color3.fromRGB(255, 255, 100))
end

local function showPing()
    local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString()
    addMessage("üì° Ping: " .. ping, Color3.fromRGB(100, 255, 255))
end

local function showPlayers()
    addMessage("üë• Ng∆∞·ªùi ch∆°i (" .. #Players:GetPlayers() .. "/" .. Players.MaxPlayers .. "):", Color3.fromRGB(100, 200, 255))
    for i, p in pairs(Players:GetPlayers()) do
        local status = p.Character and "‚úÖ" or "‚ùå"
        addMessage(i .. ". " .. status .. " " .. p.Name, Color3.fromRGB(255, 255, 100))
    end
end

local function showFPS()
    local fps = workspace:GetRealPhysicsFPS()
    addMessage("üñ•Ô∏è FPS: " .. math.floor(fps), Color3.fromRGB(100, 255, 255))
end

local function walkToPosition(x, y, z)
    local posX, posY, posZ = tonumber(x), tonumber(y), tonumber(z)
    if posX and posY and posZ and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = CFrame.new(posX, posY, posZ)
        addMessage("üö∂ ƒêi ƒë·∫øn: " .. posX .. ", " .. posY .. ", " .. posZ, Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå T·ªça ƒë·ªô kh√¥ng h·ª£p l·ªá!", Color3.fromRGB(255, 100, 100))
    end
end

local function getPosition()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local pos = player.Character.HumanoidRootPart.Position
        addMessage("üìç V·ªã tr√≠: " .. math.floor(pos.X) .. ", " .. math.floor(pos.Y) .. ", " .. math.floor(pos.Z), Color3.fromRGB(100, 255, 255))
    end
end

local function savePosition()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        savedPosition = player.Character.HumanoidRootPart.CFrame
        addMessage("üíæ L∆∞u v·ªã tr√≠", Color3.fromRGB(100, 255, 100))
    end
end

local function loadPosition()
    if savedPosition and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = savedPosition
        addMessage("üìÇ T·∫£i v·ªã tr√≠", Color3.fromRGB(100, 255, 100))
    else
        addMessage("‚ùå Ch∆∞a l∆∞u v·ªã tr√≠!", Color3.fromRGB(255, 100, 100))
    end
end

local function showServerInfo()
    local playerCount = #Players:GetPlayers()
    local gameId = game.GameId
    local placeId = game.PlaceId
    
    addMessage("üåê === SERVER INFO ===", Color3.fromRGB(100, 200, 255))
    addMessage("üë• Players: " .. playerCount .. "/" .. Players.MaxPlayers, Color3.fromRGB(255, 255, 100))
    addMessage("üéÆ Game ID: " .. gameId, Color3.fromRGB(255, 255, 100))
    addMessage("üìç Place ID: " .. placeId, Color3.fromRGB(255, 255, 100))
end

local function rejoinServer()
    addMessage("üîÑ Rejoining server...", Color3.fromRGB(100, 255, 100))
    game:GetService("TeleportService"):Teleport(game.PlaceId, player)
end

-- Visual Effects
local function startRainbow()
    if isRainbow then return end
    isRainbow = true
    addMessage("üåà B·∫≠t Rainbow", Color3.fromRGB(255, 100, 255))
    
    rainbowConnection = RunService.Heartbeat:Connect(function()
        if isRainbow and player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    local hue = tick() * 2 % 1
                    part.Color = Color3.fromHSV(hue, 1, 1)
                end
            end
        end
    end)
end

local function stopRainbow()
    isRainbow = false
    if rainbowConnection then rainbowConnection:Disconnect() end
    
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Color = Color3.fromRGB(163, 162, 165)
            end
        end
    end
    addMessage("‚úÖ T·∫Øt Rainbow", Color3.fromRGB(100, 255, 100))
end

local function addSparkles()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" and not part:FindFirstChild("Sparkles") then
                Instance.new("Sparkles", part)
            end
        end
        addMessage("‚ú® Th√™m sparkles", Color3.fromRGB(255, 255, 100))
    end
end

local function removeSparkles()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") then
                for _, effect in pairs(part:GetChildren()) do
                    if effect:IsA("Sparkles") then
                        effect:Destroy()
                    end
                end
            end
        end
        addMessage("‚úÖ X√≥a sparkles", Color3.fromRGB(100, 255, 100))
    end
end

local function addFire()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not player.Character.HumanoidRootPart:FindFirstChild("Fire") then
            Instance.new("Fire", player.Character.HumanoidRootPart)
        end
        addMessage("üî• Th√™m fire", Color3.fromRGB(255, 100, 100))
    end
end

local function removeFire()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local fire = player.Character.HumanoidRootPart:FindFirstChild("Fire")
        if fire then fire:Destroy() end
        addMessage("‚úÖ X√≥a fire", Color3.fromRGB(100, 255, 100))
    end
end

local function addSmoke()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not player.Character.HumanoidRootPart:FindFirstChild("Smoke") then
            Instance.new("Smoke", player.Character.HumanoidRootPart)
        end
        addMessage("üí® Th√™m smoke", Color3.fromRGB(150, 150, 150))
    end
end

local function removeSmoke()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local smoke = player.Character.HumanoidRootPart:FindFirstChild("Smoke")
        if smoke then smoke:Destroy() end
        addMessage("‚úÖ X√≥a smoke", Color3.fromRGB(100, 255, 100))
    end
end

local function addTrail()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not player.Character.HumanoidRootPart:FindFirstChild("Trail") then
            local attachment1 = Instance.new("Attachment", player.Character.HumanoidRootPart)
            local attachment2 = Instance.new("Attachment", player.Character.HumanoidRootPart)
            attachment1.Position = Vector3.new(0, -2.4, 0)
            attachment2.Position = Vector3.new(0, 2.4, 0)
            
            local trail = Instance.new("Trail", player.Character.HumanoidRootPart)
            trail.Attachment0 = attachment1
            trail.Attachment1 = attachment2
            trail.Lifetime = 1
            trail.Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
                ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 255, 0)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 255, 255))
            }
        end
        addMessage("üåà Th√™m trail", Color3.fromRGB(255, 200, 100))
    end
end

local function removeTrail()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, obj in pairs(player.Character.HumanoidRootPart:GetChildren()) do
            if obj:IsA("Trail") or obj:IsA("Attachment") then
                obj:Destroy()
            end
        end
        addMessage("‚úÖ X√≥a trail", Color3.fromRGB(100, 255, 100))
    end
end

local function addGlow()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" and not part:FindFirstChild("PointLight") then
                local light = Instance.new("PointLight", part)
                light.Brightness = 2
                light.Range = 20
                light.Color = Color3.fromRGB(0, 255, 255)
            end
        end
        addMessage("‚ú® Th√™m glow", Color3.fromRGB(255, 255, 100))
    end
end

local function removeGlow()
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") then
                for _, light in pairs(part:GetChildren()) do
                    if light:IsA("PointLight") then
                        light:Destroy()
                    end
                end
            end
        end
        addMessage("‚úÖ X√≥a glow", Color3.fromRGB(100, 255, 100))
    end
end

-- Script loaders (ch·ªâ gi·ªØ nh·ªØng script ho·∫°t ƒë·ªông)
local function loadScript(scriptName, url)
    pcall(function()
        loadstring(game:HttpGet(url))()
        addMessage("‚ö° T·∫£i " .. scriptName, Color3.fromRGB(100, 255, 100))
    end)
end

-- X·ª≠ l√Ω l·ªánh
local function processCommand(input)
    local args = string.split(string.lower(input), " ")
    local command = args[1]
    
    addMessage("> " .. input, Color3.fromRGB(150, 150, 255))
    
    -- Basic commands
    if command == "speed" and args[2] then setSpeed(args[2])
    elseif command == "unspeed" then resetSpeed()
    elseif command == "jump" and args[2] then setJump(args[2])
    elseif command == "unjump" then resetJump()
    elseif command == "fly" then loadScript("Vehicle Fly GUI", "https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Vehicle%20Fly%20Gui")
    elseif command == "noclip" then startNoclip()
    elseif command == "unnoclip" then stopNoclip()
    elseif command == "antiafk" then startAntiAFK()
    elseif command == "unantiafk" then stopAntiAFK()
    elseif command == "infjump" then startInfJump()
    elseif command == "uninfjump" then stopInfJump()
    elseif command == "reset" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
            addMessage("üîÑ Reset nh√¢n v·∫≠t", Color3.fromRGB(100, 255, 100))
        end
    elseif command == "clear" then
        for _,child in pairs(outputScroll:GetChildren()) do
            if child:IsA("Frame") then child:Destroy() end
        end
        outputScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        
    -- Player commands (updated - removed kill, bring, freeze, fling)
    elseif command == "tp" and args[2] then teleportToPlayer(args[2])
    elseif command == "goto" and args[2] then teleportToPlayer(args[2])
    elseif command == "view" and args[2] then viewPlayer(args[2])
    elseif command == "unview" then unviewPlayer()
    elseif command == "follow" and args[2] then followPlayer(args[2])
    elseif command == "unfollow" then unfollowPlayer()
    
    -- Character commands (updated with new commands)
    elseif command == "spin" then startSpin()
    elseif command == "unspin" then stopSpin()
    elseif command == "sit" then sitPlayer()
    elseif command == "unsit" then standPlayer()
    elseif command == "invisible" then setInvisible()
    elseif command == "uninvisible" then setVisible()
    elseif command == "emote" and args[2] then playEmote(args[2])
    elseif command == "bighead" then setBigHead()
    elseif command == "unbighead" then resetHead()
    elseif command == "smallhead" then setSmallHead()
    elseif command == "unsmallhead" then resetHead()
    elseif command == "size" and args[2] then changeSize(args[2])
    elseif command == "float" then startFloat()
    elseif command == "unfloat" then stopFloat()
    elseif command == "platform" then createPlatform()
    elseif command == "unplatform" then destroyPlatform()
    
    -- Exploit commands (updated with new commands)
    elseif command == "walkspeed" and args[2] then setSpeed(args[2])
    elseif command == "jumpheight" and args[2] then setJump(args[2])
    elseif command == "gravity" and args[2] then setGravity(args[2])
    elseif command == "ungravity" then resetGravity()
    elseif command == "esp" then startESP()
    elseif command == "unesp" then stopESP()
    elseif command == "fullbright" then startFullbright()
    elseif command == "unfullbright" then stopFullbright()
    elseif command == "nofog" then removefog()
    elseif command == "fog" then addFog()
    elseif command == "autoclick" then startAutoClicker()
    elseif command == "unautoclick" then stopAutoClicker()
    elseif command == "walkonwater" then startWalkOnWater()
    elseif command == "unwalkonwater" then stopWalkOnWater()
    elseif command == "autorespawn" then startAutoRespawn()
    elseif command == "unautorespawn" then stopAutoRespawn()
    elseif command == "bighitbox" then startBigHitbox()
    elseif command == "unbighitbox" then stopBigHitbox()
    elseif command == "clicktp" then startClickTeleport()
    elseif command == "unclicktp" then stopClickTeleport()
    elseif command == "reach" and args[2] then setReach(args[2])
    elseif command == "unreach" then resetReach()
    
    -- Utility commands (updated with new commands)
    elseif command == "copyid" then copyPlaceId()
    elseif command == "copyjob" then copyJobId()
    elseif command == "time" then showTime()
    elseif command == "ping" then showPing()
    elseif command == "players" then showPlayers()
    elseif command == "fps" then showFPS()
    elseif command == "memory" then showMemory()
    elseif command == "age" then showAge()
    elseif command == "userid" then showUserID()
    elseif command == "walkto" and args[2] and args[3] and args[4] then walkToPosition(args[2], args[3], args[4])
    elseif command == "getpos" then getPosition()
    elseif command == "savepos" then savePosition()
    elseif command == "loadpos" then loadPosition()
    elseif command == "serverinfo" then showServerInfo()
    elseif command == "rejoin" then rejoinServer()
    elseif command == "serverhop" then serverHop()
    elseif command == "shutdown" then shutdownGame()
    
    -- Tools commands (new)
    elseif command == "btools" then giveBtools()
    elseif command == "tptool" then giveTpTool()
    
    elseif command == "theme" then
        if args[2] and themes[args[2]] then
            currentTheme = args[2]
            updateTheme()
            addMessage("üé® Theme: " .. args[2], Color3.fromRGB(100, 255, 100))
        else
            addMessage("üé® Themes: dark, light, rgb", Color3.fromRGB(255, 255, 100))
        end
        
    -- Visual commands (updated with new commands)
    elseif command == "rainbow" then startRainbow()
    elseif command == "unrainbow" then stopRainbow()
    elseif command == "sparkles" then addSparkles()
    elseif command == "unsparkles" then removeSparkles()
    elseif command == "fire" then addFire()
    elseif command == "unfire" then removeFire()
    elseif command == "smoke" then addSmoke()
    elseif command == "unsmoke" then removeSmoke()
    elseif command == "trail" then addTrail()
    elseif command == "untrail" then removeTrail()
    elseif command == "glow" then addGlow()
    elseif command == "unglow" then removeGlow()
    elseif command == "bubble" then addBubble()
    elseif command == "unbubble" then removeBubble()
    elseif command == "ghost" then makeGhost()
    elseif command == "unghost" then unmakeGhost()
    
    -- Script Hub (only essential scripts)
    elseif command == "cilent" then
        loadScript("Menu Hub Client", "https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Cilent")
    elseif command == "music" then
        loadScript("Music Hub", "https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Music")
    elseif command == "graphics" then
        loadScript("Graphics Hub", "https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Graphics")
    elseif command == "paint" then
        loadScript("Paint Hub", "https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Paint")
    elseif command == "v1" then
        loadScript("Sddnin V1", "https://raw.githubusercontent.com/Sddnin0/Sddnin/refs/heads/main/V1")
    elseif command == "v15" then
        loadScript("Sddnin V1.5", "https://raw.githubusercontent.com/Sddnin0/Sddnin/refs/heads/main/V2%20Free")
    elseif command == "v2" then
        loadScript("Sddnin V2", "https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Key")
    else
        addMessage("‚ùå L·ªánh kh√¥ng t·ªìn t·∫°i!", Color3.fromRGB(255, 100, 100))
    end
end

-- S·ª± ki·ªán g·ª≠i l·ªánh
local function sendCommand()
    local input = chatInput.Text:gsub("^%s*(.-)%s*$", "%1")
    if input ~= "" then
        chatInput.Text = ""
        processCommand(input)
    end
end

sendButton.MouseButton1Click:Connect(sendCommand)
chatInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        sendCommand()
    end
end)

-- Theme button
themeButton.MouseButton1Click:Connect(function()
    local themeOrder = {"dark", "light", "rgb"}
    local currentIndex = 1
    
    for i, theme in ipairs(themeOrder) do
        if theme == currentTheme then
            currentIndex = i
            break
        end
    end
    
    local nextIndex = (currentIndex % #themeOrder) + 1
    currentTheme = themeOrder[nextIndex]
    updateTheme()
    addMessage("üé® Theme: " .. currentTheme, Color3.fromRGB(100, 255, 100))
end)

-- Minimize button
minimizeButton.MouseButton1Click:Connect(function()
    if isMinimized then
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 550, 0, 350)})
        tween:Play()
        contentFrame.Visible = true
        minimizeButton.Text = "‚àí"
        isMinimized = false
    else
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 550, 0, 40)})
        tween:Play()
        contentFrame.Visible = false
        minimizeButton.Text = "+"
        isMinimized = true
    end
end)

-- Close button
closeButton.MouseButton1Click:Connect(function()
    -- Cleanup essential connections only
    if noclipConnection then noclipConnection:Disconnect() end
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    if infJumpConnection then infJumpConnection:Disconnect() end
    if autoClickConnection then autoClickConnection:Disconnect() end
    if spinConnection then spinConnection:Disconnect() end
    if rainbowConnection then rainbowConnection:Disconnect() end
    if espConnection then espConnection:Disconnect() end
    
    screenGui:Destroy()
end)

-- F1 key
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F1 then
        screenGui.Enabled = not screenGui.Enabled
    end
end)

-- Character cleanup
player.CharacterAdded:Connect(function()
    -- Reset essential states only
    isNoclip = false
    isAntiAFK = false
    isInfJump = false
    isAutoClicker = false
    isSpin = false
    isRainbow = false
    isESP = false
    isFullbright = false
    isNoFog = false
    
    -- Disconnect essential connections
    if noclipConnection then noclipConnection:Disconnect() end
    if antiAFKConnection then antiAFKConnection:Disconnect() end
    if infJumpConnection then infJumpConnection:Disconnect() end
    if autoClickConnection then autoClickConnection:Disconnect() end
    if spinConnection then spinConnection:Disconnect() end
    if rainbowConnection then rainbowConnection:Disconnect() end
    if espConnection then espConnection:Disconnect() end
end)

-- Initialize
updateTheme()

-- Welcome messages
addMessage("üöÄ Command Hub!", Color3.fromRGB(100, 255, 100))
addMessage("üóëÔ∏è X√≥a: leave, hop, memory, size", Color3.fromRGB(255, 200, 100))
addMessage("‚ö° Script Hub: Ch·ªâ gi·ªØ 7 script c·∫ßn thi·∫øt", Color3.fromRGB(100, 255, 255))

print("Command Hub V12 - Essential loaded! Press F1 to toggle.")