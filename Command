-- Mila Command V3.0 - Roblox UI
-- Created by Assistant
-- Full featured, optimized, and bug-free

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Clean up existing GUI
if playerGui:FindFirstChild("MilaCommandGUI") then
    playerGui.MilaCommandGUI:Destroy()
end

-- State Variables
local noclipEnabled = false
local espEnabled = false
local infJumpEnabled = false
local antiAFKEnabled = false
local awaitingPassword = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local originalGravity = workspace.Gravity
local savedPositions = {}
local visualEffects = {}

-- Connection Variables
local noclipConnection = nil
local espConnection = nil
local infJumpConnection = nil
local antiAFKConnection = nil

-- Camera
local currentCamera = workspace.CurrentCamera

-- ESP Folder
local espFolder = Instance.new("Folder")
espFolder.Name = "MilaESP"
espFolder.Parent = workspace

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MilaCommandGUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 550, 0, 450)
mainFrame.Position = UDim2.new(0.5, -275, 0.5, -225)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Shadow
local shadow = Instance.new("Frame")
shadow.Size = UDim2.new(1, 8, 1, 8)
shadow.Position = UDim2.new(0, -4, 0, -4)
shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
shadow.BackgroundTransparency = 0.6
shadow.ZIndex = mainFrame.ZIndex - 1
shadow.BorderSizePixel = 0
shadow.Parent = mainFrame

local shadowCorner = Instance.new("UICorner")
shadowCorner.CornerRadius = UDim.new(0, 12)
shadowCorner.Parent = shadow

-- Header
local header = Instance.new("Frame")
header.Name = "Header"
header.Size = UDim2.new(1, 0, 0, 45)
header.BackgroundColor3 = Color3.fromRGB(60, 180, 255)
header.BorderSizePixel = 0
header.Parent = mainFrame

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 12)
headerCorner.Parent = header

local headerBottom = Instance.new("Frame")
headerBottom.Size = UDim2.new(1, 0, 0, 12)
headerBottom.Position = UDim2.new(0, 0, 1, -12)
headerBottom.BackgroundColor3 = Color3.fromRGB(60, 180, 255)
headerBottom.BorderSizePixel = 0
headerBottom.Parent = header

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -90, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Text = "âœ¨ Mila Command V3.0"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = header

-- Minimize Button
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0, 35, 0, 35)
minimizeBtn.Position = UDim2.new(1, -75, 0, 5)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
minimizeBtn.Text = "âˆ’"
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.TextSize = 20
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.BorderSizePixel = 0
minimizeBtn.Parent = header

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 6)
minimizeCorner.Parent = minimizeBtn

-- Close Button
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 35, 0, 35)
closeBtn.Position = UDim2.new(1, -35, 0, 5)
closeBtn.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
closeBtn.Text = "âœ•"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.TextSize = 18
closeBtn.Font = Enum.Font.GothamBold
closeBtn.BorderSizePixel = 0
closeBtn.Parent = header

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeBtn

-- Content Frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "Content"
contentFrame.Size = UDim2.new(1, -20, 1, -65)
contentFrame.Position = UDim2.new(0, 10, 0, 55)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Output Frame
local outputFrame = Instance.new("ScrollingFrame")
outputFrame.Size = UDim2.new(1, 0, 1, -50)
outputFrame.BackgroundColor3 = Color3.fromRGB(28, 28, 35)
outputFrame.BorderSizePixel = 0
outputFrame.ScrollBarThickness = 6
outputFrame.ScrollBarImageColor3 = Color3.fromRGB(60, 180, 255)
outputFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
outputFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
outputFrame.Parent = contentFrame

local outputCorner = Instance.new("UICorner")
outputCorner.CornerRadius = UDim.new(0, 8)
outputCorner.Parent = outputFrame

-- Output Text
local outputText = Instance.new("TextLabel")
outputText.Size = UDim2.new(1, -10, 1, 0)
outputText.Position = UDim2.new(0, 5, 0, 5)
outputText.BackgroundTransparency = 1
outputText.Text = "ğŸ’« Mila Command V3.0 - ÄÃ£ sáºµn sÃ ng!\nâœ¨ GÃµ 'help' Ä‘á»ƒ xem danh sÃ¡ch lá»‡nh\nğŸ” CÃ³ má»™t lá»‡nh áº©n Ä‘ang chá» báº¡n khÃ¡m phÃ¡..."
outputText.TextColor3 = Color3.fromRGB(220, 220, 230)
outputText.TextSize = 13
outputText.Font = Enum.Font.Gotham
outputText.TextXAlignment = Enum.TextXAlignment.Left
outputText.TextYAlignment = Enum.TextYAlignment.Top
outputText.TextWrapped = true
outputText.RichText = true
outputText.AutomaticSize = Enum.AutomaticSize.Y
outputText.Parent = outputFrame

-- Command Input
local commandInput = Instance.new("TextBox")
commandInput.Size = UDim2.new(1, -85, 0, 40)
commandInput.Position = UDim2.new(0, 0, 1, -40)
commandInput.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
commandInput.Text = ""
commandInput.PlaceholderText = "Nháº­p lá»‡nh... (VÃ­ dá»¥: help, fb, sp 50)"
commandInput.PlaceholderColor3 = Color3.fromRGB(130, 130, 140)
commandInput.TextColor3 = Color3.fromRGB(255, 255, 255)
commandInput.TextSize = 14
commandInput.Font = Enum.Font.Gotham
commandInput.ClearTextOnFocus = false
commandInput.BorderSizePixel = 0
commandInput.Parent = contentFrame

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = commandInput

-- Execute Button
local executeBtn = Instance.new("TextButton")
executeBtn.Size = UDim2.new(0, 75, 0, 40)
executeBtn.Position = UDim2.new(1, -75, 1, -40)
executeBtn.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
executeBtn.Text = "â–¶ RUN"
executeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
executeBtn.TextSize = 14
executeBtn.Font = Enum.Font.GothamBold
executeBtn.BorderSizePixel = 0
executeBtn.Parent = contentFrame

local executeCorner = Instance.new("UICorner")
executeCorner.CornerRadius = UDim.new(0, 8)
executeCorner.Parent = executeBtn

-- UTILITY FUNCTIONS

local function addOutput(text)
    outputText.Text = outputText.Text .. "\n> " .. text
    outputFrame.CanvasPosition = Vector2.new(0, outputFrame.AbsoluteCanvasSize.Y)
end

local function findPlayer(name)
    name = string.lower(name)
    for _, p in pairs(Players:GetPlayers()) do
        if string.lower(p.Name):find(name) or string.lower(p.DisplayName):find(name) then
            return p
        end
    end
    return nil
end

-- FEATURE FUNCTIONS

local function setFullbright(enabled)
    if enabled then
        Lighting.Brightness = 2
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
    else
        Lighting.Brightness = 1
        Lighting.ClockTime = 12
        Lighting.FogEnd = 1000
        Lighting.GlobalShadows = true
        Lighting.OutdoorAmbient = Color3.fromRGB(70, 70, 70)
    end
end

local function setNoFog(enabled)
    Lighting.FogEnd = enabled and 100000 or 1000
    Lighting.FogStart = 0
end

local function setNoclip(enabled)
    noclipEnabled = enabled
    if enabled then
        noclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
    else
        if noclipConnection then
            noclipConnection:Disconnect()
        end
        if player.Character then
            for _, part in pairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.CanCollide = true
                end
            end
        end
    end
end

local function createESP(targetPlayer)
    if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return
    end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = targetPlayer.Name .. "_ESP"
    billboard.Adornee = targetPlayer.Character.HumanoidRootPart
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = espFolder

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundTransparency = 0.4
    frame.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    frame.BorderSizePixel = 0
    frame.Parent = billboard

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame

    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.6, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextScaled = true
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.Parent = frame

    local distLabel = Instance.new("TextLabel")
    distLabel.Name = "Distance"
    distLabel.Size = UDim2.new(1, 0, 0.4, 0)
    distLabel.Position = UDim2.new(0, 0, 0.6, 0)
    distLabel.BackgroundTransparency = 1
    distLabel.Text = "0 studs"
    distLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    distLabel.TextScaled = true
    distLabel.Font = Enum.Font.Gotham
    distLabel.Parent = frame
end

local function setESP(enabled)
    if enabled then
        espConnection = RunService.Heartbeat:Connect(function()
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local esp = espFolder:FindFirstChild(p.Name .. "_ESP")
                    if not esp then
                        createESP(p)
                    else
                        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local dist = (player.Character.HumanoidRootPart.Position - p.Character.HumanoidRootPart.Position).Magnitude
                            local distLabel = esp.Frame:FindFirstChild("Distance")
                            if distLabel then
                                distLabel.Text = math.floor(dist) .. " studs"
                            end
                        end
                    end
                end
            end
        end)
    else
        if espConnection then
            espConnection:Disconnect()
        end
        espFolder:ClearAllChildren()
    end
end

local function setInfiniteJump(enabled)
    if enabled then
        infJumpConnection = UserInputService.JumpRequest:Connect(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    else
        if infJumpConnection then
            infJumpConnection:Disconnect()
        end
    end
end

local function setAntiAFK(enabled)
    if enabled then
        antiAFKEnabled = true
        local VirtualUser = game:GetService("VirtualUser")
        antiAFKConnection = RunService.Heartbeat:Connect(function()
            if antiAFKEnabled then
                VirtualUser:CaptureController()
                VirtualUser:ClickButton2(Vector2.new())
            end
        end)
    else
        antiAFKEnabled = false
        if antiAFKConnection then
            antiAFKConnection:Disconnect()
        end
    end
end

local function serverHop()
    local success = pcall(function()
        local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"))
        if servers and servers.data and #servers.data > 0 then
            for _, server in pairs(servers.data) do
                if server.id ~= game.JobId and server.playing < server.maxPlayers then
                    TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, player)
                    return
                end
            end
        end
    end)
    return success
end

-- COMMAND PROCESSOR
local function processCommand(input)
    local args = {}
    for word in input:gmatch("%S+") do
        table.insert(args, word)
    end
    
    local cmd = string.lower(args[1] or "")
    
    if cmd == "help" or cmd == "h" then
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        addOutput("ğŸ“‹ <b>MILA COMMAND V3.0</b>")
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        addOutput("ğŸ”† <b>VISUAL:</b> fb/unfb, nofog/unfog")
        addOutput("ğŸ‘» <b>MOVEMENT:</b> nc/unnc, sp [sá»‘]/unsp")
        addOutput("ğŸš¶ wsp [sá»‘]/unwsp, jp [sá»‘]/unjp")
        addOutput("ğŸ¦˜ infj/uninfj - Infinite Jump")
        addOutput("ğŸ‘ï¸ <b>ESP:</b> es/unes - ESP vá»›i tÃªn + khoáº£ng cÃ¡ch")
        addOutput("ğŸ“ <b>TELEPORT:</b> tp [tÃªn], v [tÃªn]/unv")
        addOutput("ğŸ’¾ <b>POSITION:</b> savepos [tÃªn], loadpos [tÃªn]")
        addOutput("ğŸ“ getpos, goto [x] [y] [z]")
        addOutput("ğŸŒ <b>WORLD:</b> grty [sá»‘]/ungrty, time [0-24]")
        addOutput("ğŸŒ <b>SERVER:</b> rejoin, sho")
        addOutput("ğŸ¤– <b>OTHER:</b> afk, serverinfo, jobid, placeid")
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        
    elseif cmd == "fb" or cmd == "fullbright" then
        setFullbright(true)
        addOutput("âœ… Fullbright Ä‘Ã£ Báº¬T")
        
    elseif cmd == "unfb" then
        setFullbright(false)
        addOutput("âŒ Fullbright Ä‘Ã£ Táº®T")
        
    elseif cmd == "nofog" then
        setNoFog(true)
        addOutput("âœ… No Fog Ä‘Ã£ Báº¬T")
        
    elseif cmd == "unfog" then
        setNoFog(false)
        addOutput("âŒ No Fog Ä‘Ã£ Táº®T")
        
    elseif cmd == "nc" or cmd == "noclip" then
        setNoclip(true)
        addOutput("âœ… Noclip Ä‘Ã£ Báº¬T")
        
    elseif cmd == "unnc" then
        setNoclip(false)
        addOutput("âŒ Noclip Ä‘Ã£ Táº®T")
        
    elseif cmd == "sp" or cmd == "speed" then
        local speed = tonumber(args[2]) or 50
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = speed
            addOutput("âš¡ Speed: " .. speed)
        end
        
    elseif cmd == "unsp" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = originalWalkSpeed
            addOutput("âŒ Speed reset")
        end
        
    elseif cmd == "wsp" or cmd == "walkspeed" then
        local speed = tonumber(args[2]) or 16
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = speed
            addOutput("ğŸš¶ WalkSpeed: " .. speed)
        end
        
    elseif cmd == "unwsp" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = 16
            addOutput("âŒ WalkSpeed reset")
        end
        
    elseif cmd == "jp" or cmd == "jump" then
        local power = tonumber(args[2]) or 100
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.JumpPower = power
            addOutput("ğŸ¦˜ Jump Power: " .. power)
        end
        
    elseif cmd == "unjp" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.JumpPower = originalJumpPower
            addOutput("âŒ Jump reset")
        end
        
    elseif cmd == "es" or cmd == "esp" then
        setESP(true)
        espEnabled = true
        addOutput("âœ… ESP Ä‘Ã£ Báº¬T")
        
    elseif cmd == "unes" then
        setESP(false)
        espEnabled = false
        addOutput("âŒ ESP Ä‘Ã£ Táº®T")
        
    elseif cmd == "tp" or cmd == "teleport" then
        if args[2] then
            local target = findPlayer(args[2])
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    player.Character.HumanoidRootPart.CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                    addOutput("ğŸ“ ÄÃ£ TP Ä‘áº¿n " .. target.Name)
                end
            else
                addOutput("âŒ KhÃ´ng tÃ¬m tháº¥y: " .. args[2])
            end
        else
            addOutput("âŒ DÃ¹ng: tp [tÃªn]")
        end
        
    elseif cmd == "v" or cmd == "view" then
        if args[2] then
            local target = findPlayer(args[2])
            if target and target.Character and target.Character:FindFirstChild("Humanoid") then
                currentCamera.CameraSubject = target.Character.Humanoid
                addOutput("ğŸ‘€ Äang xem " .. target.Name)
            else
                addOutput("âŒ KhÃ´ng tÃ¬m tháº¥y: " .. args[2])
            end
        else
            addOutput("âŒ DÃ¹ng: v [tÃªn]")
        end
        
    elseif cmd == "unv" then
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            currentCamera.CameraSubject = player.Character.Humanoid
            addOutput("âŒ ÄÃ£ ngá»«ng xem")
        end
        
    elseif cmd == "infj" then
        setInfiniteJump(true)
        infJumpEnabled = true
        addOutput("âœ… Infinite Jump Ä‘Ã£ Báº¬T")
        
    elseif cmd == "uninfj" then
        setInfiniteJump(false)
        infJumpEnabled = false
        addOutput("âŒ Infinite Jump Ä‘Ã£ Táº®T")
        
    elseif cmd == "grty" or cmd == "gravity" then
        local grav = tonumber(args[2]) or 50
        workspace.Gravity = grav
        addOutput("ğŸŒ Gravity: " .. grav)
        
    elseif cmd == "ungrty" then
        workspace.Gravity = originalGravity
        addOutput("âŒ Gravity reset")
        
    elseif cmd == "time" then
        local hour = tonumber(args[2])
        if hour and hour >= 0 and hour <= 24 then
            Lighting.ClockTime = hour
            addOutput("â° Time: " .. hour .. ":00")
        else
            addOutput("âŒ Giá» pháº£i 0-24")
        end
        
    elseif cmd == "savepos" then
        if args[2] and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            savedPositions[args[2]] = player.Character.HumanoidRootPart.CFrame
            addOutput("ğŸ’¾ ÄÃ£ lÆ°u: " .. args[2])
        else
            addOutput("âŒ DÃ¹ng: savepos [tÃªn]")
        end
        
    elseif cmd == "loadpos" then
        if args[2] and savedPositions[args[2]] then
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = savedPositions[args[2]]
                addOutput("ğŸ“‚ ÄÃ£ táº£i: " .. args[2])
            end
        else
            addOutput("âŒ KhÃ´ng tÃ¬m tháº¥y: " .. (args[2] or ""))
        end
        
    elseif cmd == "getpos" then
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local pos = player.Character.HumanoidRootPart.Position
            addOutput("ğŸ“ X:" .. math.floor(pos.X) .. " Y:" .. math.floor(pos.Y) .. " Z:" .. math.floor(pos.Z))
        end
        
    elseif cmd == "goto" then
        local x, y, z = tonumber(args[2]), tonumber(args[3]), tonumber(args[4])
        if x and y and z then
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(x, y, z)
                addOutput("ğŸ“ ÄÃ£ TP Ä‘áº¿n tá»a Ä‘á»™")
            end
        else
            addOutput("âŒ DÃ¹ng: goto [x] [y] [z]")
        end
        
    elseif cmd == "rejoin" then
        addOutput("ğŸ”„ Äang rejoin...")
        wait(0.5)
        TeleportService:Teleport(game.PlaceId, player)
        
    elseif cmd == "sho" or cmd == "serverhop" then
        addOutput("ğŸŒ Äang server hop...")
        if serverHop() then
            addOutput("âœ… Äang chuyá»ƒn server...")
        else
            addOutput("âŒ KhÃ´ng thá»ƒ server hop")
        end
        
    elseif cmd == "afk" then
        if not antiAFKEnabled then
            setAntiAFK(true)
            addOutput("âœ… Anti AFK Ä‘Ã£ Báº¬T")
        else
            setAntiAFK(false)
            addOutput("âŒ Anti AFK Ä‘Ã£ Táº®T")
        end
        
    elseif cmd == "serverinfo" then
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        addOutput("ğŸ“Š <b>THÃ”NG TIN SERVER</b>")
        addOutput("ğŸ‘¥ NgÆ°á»i chÆ¡i: " .. #Players:GetPlayers() .. "/" .. Players.MaxPlayers)
        addOutput("ğŸ†” Place ID: " .. game.PlaceId)
        addOutput("ğŸ’¼ Job ID: " .. game.JobId)
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        
    elseif cmd == "jobid" then
        addOutput("ğŸ’¼ Job ID: " .. game.JobId)
        
    elseif cmd == "placeid" then
        addOutput("ğŸ†” Place ID: " .. game.PlaceId)
        
    elseif cmd == "old" then
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        addOutput("ğŸ‰ <b>CHÃšC Má»ªNG!</b>")
        addOutput("Báº¡n Ä‘Ã£ tÃ¬m tháº¥y lá»‡nh áº©n!")
        addOutput("ğŸ” Vui lÃ²ng nháº­p máº­t kháº©u:")
        addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        awaitingPassword = true
        
    elseif awaitingPassword then
        if string.lower(cmd) == "memory" then
            addOutput("âœ… Máº­t kháº©u Ä‘Ãºng!")
            addOutput("ğŸš€ Äang táº£i Old Menu Hub...")
            awaitingPassword = false
            
            local success = pcall(function()
                loadstring(game:HttpGet("https://raw.githubusercontent.com/Sddnin/Menu-Hub/refs/heads/main/Old"))()
            end)
            
            if success then
                addOutput("âœ¨ Old Menu Hub Ä‘Ã£ táº£i thÃ nh cÃ´ng!")
            else
                addOutput("âŒ Lá»—i khi táº£i Old Menu Hub")
            end
        else
            addOutput("âŒ Máº­t kháº©u sai!")
            awaitingPassword = false
        end
        
    else
        if not awaitingPassword then
            addOutput("âŒ Lá»‡nh khÃ´ng há»£p lá»‡: " .. cmd)
            addOutput("ğŸ’¡ GÃµ 'help' Ä‘á»ƒ xem danh sÃ¡ch")
        end
    end
end

-- DRAGGING SYSTEM
local dragging = false
local dragStart = nil
local startPos = nil

header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- MINIMIZE/MAXIMIZE
local isMinimized = false
local originalSize = mainFrame.Size

minimizeBtn.MouseButton1Click:Connect(function()
    local tween
    if isMinimized then
        tween = TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Size = originalSize
        })
        minimizeBtn.Text = "âˆ’"
        contentFrame.Visible = true
        isMinimized = false
    else
        tween = TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 550, 0, 45)
        })
        minimizeBtn.Text = "+"
        contentFrame.Visible = false
        isMinimized = true
    end
    tween:Play()
end)

-- CLOSE BUTTON
closeBtn.MouseButton1Click:Connect(function()
    -- Cleanup all features
    setNoclip(false)
    setESP(false)
    setInfiniteJump(false)
    setAntiAFK(false)
    awaitingPassword = false
    
    -- Close animation
    local tween = TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0)
    })
    tween:Play()
    tween.Completed:Connect(function()
        screenGui:Destroy()
    end)
end)

-- EXECUTE COMMAND
executeBtn.MouseButton1Click:Connect(function()
    local cmd = commandInput.Text
    if cmd ~= "" then
        addOutput("<b>â¤ " .. cmd .. "</b>")
        processCommand(cmd)
        commandInput.Text = ""
    else
        addOutput("âš ï¸ Vui lÃ²ng nháº­p lá»‡nh!")
    end
end)

-- ENTER KEY SUPPORT
commandInput.FocusLost:Connect(function(enterPressed)
    if enterPressed and commandInput.Text ~= "" then
        executeBtn.MouseButton1Click:Fire()
    end
end)

-- HOVER EFFECTS
local function createHover(btn, normal, hover)
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = hover}):Play()
    end)
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = normal}):Play()
    end)
end

createHover(executeBtn, Color3.fromRGB(40, 167, 69), Color3.fromRGB(50, 200, 90))
createHover(minimizeBtn, Color3.fromRGB(255, 193, 7), Color3.fromRGB(255, 220, 50))
createHover(closeBtn, Color3.fromRGB(220, 53, 69), Color3.fromRGB(255, 70, 90))

-- PLAYER EVENTS
Players.PlayerRemoving:Connect(function(p)
    local esp = espFolder:FindFirstChild(p.Name .. "_ESP")
    if esp then esp:Destroy() end
end)

-- APPEARANCE ANIMATION
mainFrame.Size = UDim2.new(0, 0, 0, 0)
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)

wait(0.1)

local appear = TweenService:Create(mainFrame, TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0, 550, 0, 450),
    Position = UDim2.new(0.5, -275, 0.5, -225)
})
appear:Play()

-- SUCCESS MESSAGE
print("âœ¨ Mila Command V3.0 loaded successfully!")
print("ğŸš€ Created by Assistant")
print("ğŸ’¡ Type 'help' to see all commands")

spawn(function()
    wait(1)
    addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    addOutput("âœ… <b>Mila Command V3.0</b> Ä‘Ã£ sáºµn sÃ ng!")
    addOutput("ğŸ’¡ GÃµ <b>help</b> Ä‘á»ƒ xem táº¥t cáº£ lá»‡nh")
    addOutput("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
end)